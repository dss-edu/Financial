<!DOCTYPE html>
{% extends 'temps/base.html' %}
{% load static %}
{% block title %}
{{ school_name }}
{% endblock %}
{% block stylesheet %}
<link rel="stylesheet" href="{% static 'css/profit-loss.css' %}">
{% endblock %}

{% block body %}
 <div id="content-wrapper">
  
  <nav class="navbar navbar-expand navbar-dark bg-dark ">

    <a class="navbar-brand mr-1 text-primary " href="" ></a>
    

    <!-- Navbar Search -->
    <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
      
    </form>
    <a class="navbar-brand mr-1 text-primary " href="https://app.powerbi.com/groups/031634b4-01f7-4358-856c-e48f6f5fcaca/reports/fd891db5-908a-4463-9807-eece4c2c2f76/ReportSection6c18d619620bd9b8337e?experience=power-bi" data-toggle="tooltip" title="view in powerbi" target="_blank"><i class="fas fa-file-powerpoint"  ></i></a>
    <!-- Navbar -->
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <a class="navbar-brand mr-1 text-primary " href="/profit-loss-charts/{{ school }}" data-toggle="tooltip" title="view as chart"><i class="fas fa-chart-bar" ></i></a>
    
    <!-- &nbsp; -->
    <!-- &nbsp; -->
    <!-- &nbsp; -->
    <!-- &nbsp; -->
    <!-- <a id="export-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="export to pdf"><i class="fas fa-file-pdf"></i></a> -->
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <a id="export-excel-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="export to excel"><i class="fas fa-file-excel"></i></a>
  </nav>
  {% comment %} <script>
      document.getElementById('export-pdf-button').addEventListener('click', function (event) {
      event.preventDefault(); 

        // Show the confirmation modal
      var confirmationModal = document.getElementById("confirmation-modal");
      var confirmYes = document.getElementById("confirm-yes");
      var confirmNo = document.getElementById("confirm-no");

      
      confirmYes.addEventListener("click", function () {
        var element = document.getElementById('data-table');
      var rows = element.getElementsByTagName('tr');
      for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName('td');
        var headerCells = rows[i].getElementsByTagName('th');

        if (cells.length > 0) {
          rows[i].removeChild(cells[0]);
          
        }

        if (headerCells.length > 0) {
          rows[i].removeChild(headerCells[0]);
          
        }

      }

      
      expandColumns();
      for (var rowId = 1; rowId <= 100; rowId++) {
        expandRow(rowId);
      }

      var options = {
        margin: 2,
        filename: 'exported_table.pdf',
        image: { type: 'png', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: [700,700], orientation: 'portrait' },
      };

      confirmationModal.style.display = "none";

      $('#spinner-modal').modal('show');
      html2pdf().set(options).from(element).outputPdf().then(function(pdf){
          $('#spinner-modal').modal('hide');
      }).save();
      
      });

      confirmNo.addEventListener("click", function () {
        var element = document.getElementById('data-table');
        hideRowsOnLoad();
              var rows = element.getElementsByTagName('tr');
      for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName('td');
        var headerCells = rows[i].getElementsByTagName('th');

        if (cells.length > 0) {
          rows[i].removeChild(cells[0]);
          
        }

        if (headerCells.length > 0) {
          rows[i].removeChild(headerCells[0]);
          
        }

      }

        var options = {
          margin: 2,
          filename: 'exported_table.pdf',
          image: { type: 'png', quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'mm', format: [700,700], orientation: 'portrait' },
        };

      $('#spinner-modal').modal('show');
      html2pdf().set(options).from(element).outputPdf().then(function(pdf){
          $('#spinner-modal').modal('hide');
      }).save();
        
      confirmationModal.style.display = "none";

      });
      
      confirmationModal.style.display = "block";
    });

    function expandRow(rowId) {
      for (var i = 0; i <= 100; i++) {
        var row = document.getElementById("row" + rowId + "-" + i);
        if (row) {
          row.style.display = "table-row";
        }
      }
    }

    function expandColumns() {
      var collapsedColumns = document.getElementsByClassName("collapsed");
      for (var i = 0; i < collapsedColumns.length; i++) {
        collapsedColumns[i].style.display = "table-cell";
      }
    }


  </script> {% endcomment %}


  <div class="modal" id="confirmation-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content" style="height: 80%;">

        <div class="modal-body">
           <h4>Export Confirmation</h4>
          <p>Do you want the detailed view?</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="confirm-yes" class="btn btn-primary">Yes</button>
          <button type="button" id="confirm-no" class="btn btn-secondary" data-dismiss="modal">No</button>
        </div>
      </div>
    </div>
  </div>

    <div class="modal" id="spinner-modal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-dialog-centered d-flex justify-content-center align-items-center" role="document">
            <div class="modal-content  p-0 w-auto h-auto">
                <div class="modal-body text-center">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End of spinner modal -->


<div class="modal" id="myModal">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
       
        <table class="table table-hover" id="balancesheet-data-table1">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
            <th>Real</th>
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
            
            </tr>
          </thead>
          <tbody id="modal-table-body">
      
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal1-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></a>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="export-excel2-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="EXCEL"><i class="fas fa-file-excel"></i></a>
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('exportmodal1-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table1');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>

<script>

  document.getElementById('export-excel2-button').addEventListener('click', function (event) {
    event.preventDefault(); 
 
  var table = document.getElementById("balancesheet-data-table1"); // Use the table containing the headers

  
  var wb = XLSX.utils.book_new();

  var ws = XLSX.utils.table_to_sheet(table);

  XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

 
  var wbout = XLSX.write(wb, { bookType: "xlsx", type: "array" });

  var blob = new Blob([wbout], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });

  
  var link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "data.xlsx";
  link.click();
});

</script>

<div class="modal" id="myModal2">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
        <!-- Modify the table to display the data from the viewgl function -->
        <table class="table table-hover" id="balancesheet-data-table2">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
           
            <th>Real</th>
       
           
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
         
            </tr>
          </thead>
          <tbody id="modal2-table-body">
            <!-- The data from the viewgl function will be populated here -->
          </tbody>
        </table>
      </div>
      <div class="modal2-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal2-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></i></a>
        
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('exportmodal2-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table2');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>


<div class="modal" id="myModal3">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
        <!-- Modify the table to display the data from the viewgl function -->
        <table class="table table-hover" id="balancesheet-data-table3">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
           
            <th>Real</th>
       
           
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
         
            </tr>
          </thead>
          <tbody id="modal3-table-body">
            <!-- The data from the viewgl function will be populated here -->
          </tbody>
        </table>
      </div>
      <div class="modal3-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal3-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></i></a>
        
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('exportmodal3-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table3');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>

{% comment %} <div id="dataCheckModal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="height: 80%;">

      <div class="modal-body">
         
        <p id="modal-text"></p>
      </div>
      <div class="modal-footer">
     
        <button type="button" class="close" class="btn btn-secondary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div> {% endcomment %}




<div class="table-container"  >
<form  id="insert-row-form" action="{% url 'insert-row' %}" method="POST">
 
  <div id="edit-container" >
    <button id="edit-button" class="btn btn-sm btn-success" type="button" style=" float: right;">Edit</button>
</div>

<div id="cancel-container" style="display: none;"> 
  <button id="cancel-button" class="btn btn-sm btn-success" type="button" style=" float: right; margin-left: 10px;" >Cancel</button>
</div>

<div id="save-container" style="display: none; ">
    <button id="save-button" class="btn btn-sm btn-success" style="float: right; margin-left: 10px; " >Save</button>
</div>


<script>
    document.getElementById("edit-button").addEventListener("click", function() {
        // Hide the "Edit" container
        document.getElementById("edit-container").style.display = "none";

        // Show the "Save" container
        document.getElementById("save-container").style.display = "block";
        document.getElementById("cancel-container").style.display = "block";
        
        
        
        var valueCells = document.querySelectorAll("[id^='value-cell-']");
        valueCells.forEach(function(cell) {
            cell.contentEditable = "true";
        });

       
 
        
        
    });

    document.getElementById("cancel-button").addEventListener("click", function() {
        // Hide the "Save" container
        
        document.getElementById("save-container").style.display = "none";
        document.getElementById("cancel-container").style.display = "none";
       

        

        // Show the "Edit" container
        document.getElementById("edit-container").style.display = "block";
        var valueCells = document.querySelectorAll("[id^='value-cell-']");
        valueCells.forEach(function(cell) {
            cell.contentEditable = "false";
        });

       
     
       
        
    });
</script>

  {% csrf_token %}
    <table id="data-table" class="table table-hover" width="100%"> 
        <thead>
          <tr>
            <th class="firstcolumn"></th>
            <th class="collapsed"></th>
          
            <th colspan="17" style="white-space: nowrap;">
                <h2 style="text-align: center;">{{ school_name }}</h2><br>
                <h2 style="text-align: center;">FY{{months.FY_year_1}}-{{months.FY_year_2}} Statement of Activities as of {{months.last_month}}</h2><br>
            </th>

            
        </tr>
        <tr>
          <script>
            for (var i = 0; i <= 18; i++){
              if (i === 0){
                document.write(`<td  class="firstcolumn"></td>`);

              }
              else if (i === 1){
                document.write(`<td  class="collapsed"></td>`);

              }
              else if (i === 5 ) {
                document.write(`<th><button id="toggle-button" type="button" class="expand-button" onclick="toggleColumns(); hide17thColumn();" >+</button></th>`);
              }
              else if(i>=6 && i<=16){
                document.write(`<td  class="collapsed"></td>`);
              }
              else{
                document.write(`<td  ></td>`);
              }
            }
            
          </script>
        </tr>

        {% if  school != 'manara' and school != 'prepschool' %}
        <script>
          var last_month_number = parseInt("{{months.last_month_number}}", 10); // Parse it as an integer
           // Add 11 to it
           console.log(last_month_number)
           if (last_month_number >= 9) {
            last_month_number -= 3;
            
        } 
        else {
            last_month_number +=10;
            
        }
          
          function hide17thColumn() {
            for (var i = last_month_number; i <= 17; i++) {
              var columnsToHide = document.querySelectorAll("th:nth-child(" + i + "), td:nth-child(" + i + ")");
          
              for (var j = 0; j < columnsToHide.length; j++) {
                  columnsToHide[j].style.display = "none";
              }
          }
        }
        </script> 
        <tr class="header">
          <th class="firstcolumn" ></th>
          <th class="collapsed" ></th>
          <th ></th>
          <th style="text-align: center; "><div style="width: 100px;">Ammended <br>Budget          </div></th>
          <th style="text-align: center; "><div style="width: 100px;">{{months.format_ytd_budget}}% YTD <br>Budget</div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">September</div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">October  </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">November </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">December </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">January  </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">February </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">March    </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">April    </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">May      </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">June     </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">July     </div></th>
          <th class="collapsed" style="text-align: center;"><div style="width: 100px;">August   </div></th>
          <th style="text-align: center;"><div style="width: 100px;">Year-to-Date               </div></th>
          <th style="text-align: center;"><div style="width: 100px;">Variances                  </div></th>
          <th style="text-align: center;"><div style="width: 100px;">Var.({{months.format_ytd_budget}}%)</div></th>
        </tr>


        
        </thead>
    <tbody id="data-table-body">
        


       
    
        <!-- LOCAL REVENUE COLUMN START-->
      {% for row in data %}
        {% if row.category == 'Local Revenue' %}
            <tr id="row1-{{ forloop.counter }}" class="local-revenue-row">
                <td class="firstcolumn"><a href=" {% url 'delete' row.fund row.obj  %}"  style="display:none;"><i class="fas fa-times"></i></a></td>
         
                <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
                <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
                <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
                  {% if row.total_budget == 0.0 %}
                      <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}"> 
                  {% else %}
                      <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}">{{ row.total_budget }}
                  {% endif %}
                </td>
           
                <td  class="right-align-td">{{row.ytd_budget}}</td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10}}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5}}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
                <td class="right-align-td">{{ row.ytd_total }}</td>
                <td class="right-align-td"></td>
                <td class="right-align-td"></td>
            </tr>

            
            
            
        {% endif %}
      {% endfor %}
      
      
        
      

      
        <tr id="ttl-row" class="ttl-lr-row">
            <td class="firstcolumn">
              <button id="row1" class="expand-button"  type="button" onclick="toggleRow(1); toggleborderlr();" >+</button>
              
            </td>
            <td class="collapsed"></td>
            <td  ><strong>Local Revenue</strong></td>
            <td id="local-revenue-total-3" class=" right-align-td" >{{totals.total_ammended_lr }}</td>
            <td id="local-revenue-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_lr}}</td>
            <td id="local-revenue-total-5" class="collapsed right-align-td" >{{ totals.total_lr.09 }}</td>
            <td id="local-revenue-total-6" class="collapsed right-align-td" >{{ totals.total_lr.10 }}</td>
            <td id="local-revenue-total-7" class="collapsed right-align-td" >{{ totals.total_lr.11 }}</td>
            <td id="local-revenue-total-8" class="collapsed right-align-td" >{{ totals.total_lr.12 }}</td>
            <td id="local-revenue-total-9" class="collapsed right-align-td" >{{ totals.total_lr.01 }}</td>
            <td id="local-revenue-total-10" class="collapsed right-align-td">{{ totals.total_lr.02 }}</td>
            <td id="local-revenue-total-11" class="collapsed right-align-td">{{ totals.total_lr.03 }}</td>
            <td id="local-revenue-total-12" class="collapsed right-align-td">{{ totals.total_lr.04 }}</td>
            <td id="local-revenue-total-13" class="collapsed right-align-td">{{ totals.total_lr.05 }}</td>
            <td id="local-revenue-total-14" class="collapsed right-align-td">{{ totals.total_lr.06 }}</td>
            <td id="local-revenue-total-15" class="collapsed right-align-td">{{ totals.total_lr.07 }}</td>
            <td id="local-revenue-total-16" class="collapsed right-align-td">{{ totals.total_lr.08 }}</td>
            <td id="local-revenue-total-17" class="right-align-td ">{{totals.ytd_total_lr}}</td>
            <td id="local-revenue-total-18" class="right-align-td ">{{totals.variances_revenue_lr}}</td>
            <td id="local-revenue-total-19" class="right-align-td">{{totals.var_ytd_lr}}</td>

        </tr>
        <script>
          function toggleborderlr() {
            var fprTotalCells = document.querySelectorAll('[id^="local-revenue-total-"]');
            
            for (var i = 1; i <= 16; i++) {
              fprTotalCells[i - 1].classList.toggle("top-border");
            }
          }
        </script>

        <!-- STATE PROGRAM COLUMN START-->
        {% for row in data %}
        {% if row.category == 'State Program Revenue' %}
          <tr id="row2-{{ forloop.counter }}" class="spr-row">
            <td class="firstcolumn"></td>
            <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
            <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
            <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
            {% if row.total_budget == 0.0 %}
                <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}"> 
            {% else %}
                <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}">{{ row.total_budget }}
            {% endif %}
            </td>
    
            <td class="right-align-td">{{row.ytd_budget}}</td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7}}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
            <td class="right-align-td">{{ row.ytd_total }}</td>
            <td class="right-align-td">{{ row.variances }}</td>
            <td class="right-align-td"></td>
        </tr>
 
      
        {% endif %}
        {% endfor %}


        


        <tr id="ttl-row" class="ttl-spr-row">
          <td class="firstcolumn">
            <button id="row2" class="expand-button" type="button" onclick="toggleRow(2); toggleborderspr();">+</button>
           
          </td>
          <td class="collapsed"></td>
          <td ><strong>State Program Revenue</strong></td>
          <td id="spr-total-3" class=" right-align-td" >{{ totals.total_ammended_spr }}</td>
          <td id="spr-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_spr}} </td>
          <td id="spr-total-5" class="collapsed right-align-td" >{{ totals.total_spr.09 }}</td>
          <td id="spr-total-6" class="collapsed right-align-td" >{{ totals.total_spr.10 }}</td>
          <td id="spr-total-7" class="collapsed right-align-td" >{{ totals.total_spr.11 }}</td>
          <td id="spr-total-8" class="collapsed right-align-td" >{{ totals.total_spr.12 }}</td>
          <td id="spr-total-9" class="collapsed right-align-td" >{{ totals.total_spr.01 }}</td>
          <td id="spr-total-10" class="collapsed right-align-td">{{ totals.total_spr.02 }}</td>
          <td id="spr-total-11" class="collapsed right-align-td">{{ totals.total_spr.03 }}</td>
          <td id="spr-total-12" class="collapsed right-align-td">{{ totals.total_spr.04 }}</td>
          <td id="spr-total-13" class="collapsed right-align-td">{{ totals.total_spr.05 }}</td>
          <td id="spr-total-14" class="collapsed right-align-td">{{ totals.total_spr.06 }}</td>
          <td id="spr-total-15" class="collapsed right-align-td">{{ totals.total_spr.07 }}</td>
          <td id="spr-total-16" class="collapsed right-align-td">{{ totals.total_spr.08 }}</td>
          <td id="spr-total-17" class="right-align-td ">{{totals.ytd_total_spr}}</td>
          <td id="spr-total-18" class="right-align-td ">{{totals.variances_revenue_spr}}</td>
          <td id="spr-total-19" class="right-align-td">{{totals.var_ytd_spr}}</td>
      </tr>
      <script>
        function toggleborderspr() {
          var fprTotalCells = document.querySelectorAll('[id^="spr-total-"]');
          
          for (var i = 1; i <= 16; i++) {
            fprTotalCells[i - 1].classList.toggle("top-border");
          }
        }
      </script>
      
      <!-- Federal Program Revenue COLUMN START-->
      {% for row in data %}
      {% if row.category == 'Federal Program Revenue' %}
      <tr id="row3-{{ forloop.counter }}" class="fpr-row">
          <td  class="firstcolumn"></td>
          <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
          <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
          {% if row.total_budget == 0.0 %}
            <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}"> 
          {% else %}
            <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}">{{ row.total_budget }}
          {% endif %}
          </td>
          
          <td class="right-align-td">{{row.ytd_budget}}</td>
          
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
          <td class="right-align-td">{{ row.ytd_total }}</td>
          <td class="right-align-td">{{ row.variances }}</td>
          <td class="right-align-td"></td>
      </tr>
     
          
      {% endif %}
      {% endfor %}



      <tr id="ttl-row" class="ttl-fpr-row">
        <td class="firstcolumn">
          <button id="row3" class="expand-button" type="button" onclick="toggleRow(3); toggleborderfpr(); " >+</button>
          
        </td>
        <td class="collapsed"></td>
        <td  ><strong>Federal Program Revenue</strong></td>
        <td id="fpr-total-3" class=" right-align-td" >{{totals.total_ammended_fpr }}</td>
        <td id="fpr-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_fpr}}</td>
        <td id="fpr-total-5" class="collapsed right-align-td" >{{ totals.total_fpr.09 }}</td>
        <td id="fpr-total-6" class="collapsed right-align-td" >{{ totals.total_fpr.10 }}</td>
        <td id="fpr-total-7" class="collapsed right-align-td" >{{ totals.total_fpr.11 }}</td>
        <td id="fpr-total-8" class="collapsed right-align-td" >{{ totals.total_fpr.12 }}</td>
        <td id="fpr-total-9" class="collapsed right-align-td" >{{ totals.total_fpr.01 }}</td>
        <td id="fpr-total-10" class="collapsed right-align-td">{{ totals.total_fpr.02 }}</td>
        <td id="fpr-total-11" class="collapsed right-align-td">{{ totals.total_fpr.03 }}</td>
        <td id="fpr-total-12" class="collapsed right-align-td">{{ totals.total_fpr.04 }}</td>
        <td id="fpr-total-13" class="collapsed right-align-td">{{ totals.total_fpr.05 }}</td>
        <td id="fpr-total-14" class="collapsed right-align-td">{{ totals.total_fpr.06 }}</td>
        <td id="fpr-total-15" class="collapsed right-align-td">{{ totals.total_fpr.07 }}</td>
        <td id="fpr-total-16" class="collapsed right-align-td">{{ totals.total_fpr.08 }}</td>
        <td id="fpr-total-17" class="right-align-td ">{{totals.ytd_total_fpr}}</td>
        <td id="fpr-total-18" class="right-align-td ">{{totals.variances_revenue_fpr}}</td>
        <td id="fpr-total-19" class="right-align-td">{{totals.var_ytd_fpr}}</td>
      </tr>
      <script>
        function toggleborderfpr() {
          var fprTotalCells = document.querySelectorAll('[id^="fpr-total-"]');
          
          for (var i = 1; i <= 16; i++) {
            fprTotalCells[i - 1].classList.toggle("top-border");
          }
        }
      </script>
      

      <tr id="total-row" class="ttl-0-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Total Revenue</strong></td>
        <td id="fpr-total-3" class=" right-align-td top-border" >{{ totals.total_ammended }}</td>
        <td id="fpr-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_total}}</td>
        <td id="fpr-total-5" class="collapsed right-align-td  top-border">{{ totals.total_revenue.09 }}</td>
        <td id="fpr-total-6" class="collapsed right-align-td  top-border">{{ totals.total_revenue.10 }}</td>
        <td id="fpr-total-7" class="collapsed right-align-td  top-border">{{ totals.total_revenue.11 }}</td>
        <td id="fpr-total-8" class="collapsed right-align-td  top-border">{{ totals.total_revenue.12 }}</td>
        <td id="fpr-total-9" class="collapsed right-align-td  top-border">{{ totals.total_revenue.01 }}</td>
        <td id="fpr-total-10" class="collapsed right-align-td top-border">{{ totals.total_revenue.02 }}</td>
        <td id="fpr-total-11" class="collapsed right-align-td top-border">{{ totals.total_revenue.03 }}</td>
        <td id="fpr-total-12" class="collapsed right-align-td top-border">{{ totals.total_revenue.04 }}</td>
        <td id="fpr-total-13" class="collapsed right-align-td top-border">{{ totals.total_revenue.05 }}</td>
        <td id="fpr-total-14" class="collapsed right-align-td top-border">{{ totals.total_revenue.06 }}</td>
        <td id="fpr-total-15" class="collapsed right-align-td top-border">{{ totals.total_revenue.07 }}</td>
        <td id="fpr-total-16" class="collapsed right-align-td top-border">{{ totals.total_revenue.08 }}</td>
        <td id="fpr-total-17" class="right-align-td top-border">{{totals.ytd_total_revenue}}</td>
        <td id="fpr-total-18" class="right-align-td top-border">{{totals.variances_revenue}}</td>
        <td id="fpr-total-19" class="right-align-td">{{totals.var_ytd}}</td>
      </tr>

    {% for row in data2 %}
    {% if row.category != 'Depreciation and Amortization' %}
      
      <tr id="row11-{{ forloop.counter }}" class="total-row1">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">{{ row.func_func }}-{{ row.desc }}</td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{ row.budget }}
            {% endif %} 
          </td>
          
          
          <td  class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{ row.total_func9 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{ row.total_func10 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{ row.total_func11 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{ row.total_func12 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{ row.total_func1 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{ row.total_func2 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{ row.total_func3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{ row.total_func4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{ row.total_func5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{ row.total_func6 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{ row.total_func7 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{ row.total_func8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_ytd}}</td>
      </tr>
    {% endif %}
    {% endfor %}



      <tr id="total-row1" class="ttl-1-row">
        <td class="firstcolumn">
          
          <button id="row11" class="expand-button"  type="button" onclick="toggleRow(11); togglebordertotal1();" >-</button>
          
        </td>
        <td class="collapsed"></td>
        <td  ><strong>Total </strong></td>
        <td id="total1-3" class=" right-align-td top-border" >{{totals.first_total}}</td>
        <td id="total1-4" class=" right-align-td top-border" >{{totals.ytd_ammended_total_first}}</td>
        <td id="total1-5" class="collapsed right-align-td  top-border">{{totals.first_total_months.09}}</td>
        <td id="total1-6" class="collapsed right-align-td  top-border">{{totals.first_total_months.10}}</td>
        <td id="total1-7" class="collapsed right-align-td  top-border">{{totals.first_total_months.11}}</td>
        <td id="total1-8" class="collapsed right-align-td  top-border">{{totals.first_total_months.12}}</td>
        <td id="total1-9" class="collapsed right-align-td  top-border">{{totals.first_total_months.01}}</td>
        <td id="total1-10" class="collapsed right-align-td top-border">{{totals.first_total_months.02}}</td>
        <td id="total1-11" class="collapsed right-align-td top-border">{{totals.first_total_months.03}}</td>
        <td id="total1-12" class="collapsed right-align-td top-border">{{totals.first_total_months.04}}</td>
        <td id="total1-13" class="collapsed right-align-td top-border">{{totals.first_total_months.05}}</td>
        <td id="total1-14" class="collapsed right-align-td top-border">{{totals.first_total_months.06}}</td>
        <td id="total1-15" class="collapsed right-align-td top-border">{{totals.first_total_months.07}}</td>
        <td id="total1-16" class="collapsed right-align-td top-border">{{totals.first_total_months.08}}</td>
        <td id="total1-17" class="right-align-td top-border">{{totals.first_ytd_total}}</td>
        <td id="total1-18" class="right-align-td top-border">{{totals.variances_first_total}}</td>
        <td id="total1-19" class="right-align-td">{{totals.var_ytd_first_total}}</td>
      </tr>
      <script>
        function togglebordertotal1() {
          var fprTotalCells = document.querySelectorAll('[id^="total1-"]');
          
          for (var i = 1; i <= 16; i++) {
            fprTotalCells[i - 1].classList.toggle("top-border");
          }
        }
      </script>

      <tr id="surplus-row1" class="surplus-ttl-1-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Surplus (Deficits) before Depreciation</strong></td>
        <td id="surplus-total-3" class=" right-align-td top-border" >{{totals.ammended_budget_SBD}}</td>
        <td id="surplus-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_SBD}}</td>
        <td id="surplus-total-5" class="collapsed right-align-td  top-border">{{totals.total_SBD.09}}</td>
        <td id="surplus-total-6" class="collapsed right-align-td  top-border">{{totals.total_SBD.10}}</td>
        <td id="surplus-total-7" class="collapsed right-align-td  top-border">{{totals.total_SBD.11}}</td>
        <td id="surplus-total-8" class="collapsed right-align-td  top-border">{{totals.total_SBD.12}}</td>
        <td id="surplus-total-9" class="collapsed right-align-td  top-border">{{totals.total_SBD.01}}</td>
        <td id="surplus-total-10" class="collapsed right-align-td top-border">{{totals.total_SBD.02}}</td>
        <td id="surplus-total-11" class="collapsed right-align-td top-border">{{totals.total_SBD.03}}</td>
        <td id="surplus-total-12" class="collapsed right-align-td top-border">{{totals.total_SBD.04}}</td>
        <td id="surplus-total-13" class="collapsed right-align-td top-border">{{totals.total_SBD.05}}</td>
        <td id="surplus-total-14" class="collapsed right-align-td top-border">{{totals.total_SBD.06}}</td>
        <td id="surplus-total-15" class="collapsed right-align-td top-border">{{totals.total_SBD.07}}</td>
        <td id="surplus-total-16" class="collapsed right-align-td top-border">{{totals.total_SBD.08}}</td>
        <td id="surplus-total-17" class="right-align-td top-border">{{totals.ytd_SBD}}</td>
        <td id="surplus-total-18" class="right-align-td top-border">{{totals.variances_SBD}}</td>
        <td id="surplus-total-19" class="right-align-td">{{totals.var_SBD}}</td>
      </tr>


      <!-- Depreciation and  amortization start -->

      {% for row in data2 %}
      {% if row.category == 'Depreciation and Amortization' %}
      
      <tr id="row12-{{ forloop.counter }}" class="DnA-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td style="white-space: nowrap;"><input type="hidden" class="form-control"  placeholder="Description" value="{{row.func_func}}">
            
            {{ row.func_func }} - {{ row.desc }}
            {{row.obj}}
          </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control"  placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td  class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{row.total_func2_9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{row.total_func2_10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{row.total_func2_11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{row.total_func2_12}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{row.total_func2_1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{row.total_func2_2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{row.total_func2_3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{row.total_func2_4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{row.total_func2_5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{row.total_func2_6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{row.total_func2_7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{row.total_func2_8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_ytd}}</td>
      </tr>
      

      {% endif %}
    {% endfor %}


      <tr class="DnA-row-total">
        <td class="firstcolumn">
          <button id="row12" class="expand-button"  type="button" onclick="toggleRow(12); toggleborderDNA();" >-</button>
          
          
        </td>
        <td class="collapsed"></td>
        <td><strong>Depreciation and Amortization</strong></td>
        <td id="DnA-total-3" class=" right-align-td top-border" >{{totals.dna_total}}</td>
        <td id="DnA-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_dna}}</td>
        <td id="DnA-total-5" class="collapsed right-align-td  top-border">{{totals.dna_total_months.09}}</td>
        <td id="DnA-total-6" class="collapsed right-align-td  top-border">{{totals.dna_total_months.10}}</td>
        <td id="DnA-total-7" class="collapsed right-align-td  top-border">{{totals.dna_total_months.11}}</td>
        <td id="DnA-total-8" class="collapsed right-align-td  top-border">{{totals.dna_total_months.12}}</td>
        <td id="DnA-total-9" class="collapsed right-align-td  top-border">{{totals.dna_total_months.01}}</td>
        <td id="DnA-total-10" class="collapsed right-align-td top-border">{{totals.dna_total_months.02}}</td>
        <td id="DnA-total-11" class="collapsed right-align-td top-border">{{totals.dna_total_months.03}}</td>
        <td id="DnA-total-12" class="collapsed right-align-td top-border">{{totals.dna_total_months.04}}</td>
        <td id="DnA-total-13" class="collapsed right-align-td top-border">{{totals.dna_total_months.05}}</td>
        <td id="DnA-total-14" class="collapsed right-align-td top-border">{{totals.dna_total_months.06}}</td>
        <td id="DnA-total-15" class="collapsed right-align-td top-border">{{totals.dna_total_months.07}}</td>
        <td id="DnA-total-16" class="collapsed right-align-td top-border">{{totals.dna_total_months.08}}</td>
        <td id="DnA-total-17" class="right-align-td top-border">{{totals.dna_ytd_total}}</td>
        <td id="DnA-total-18" class="right-align-td top-border">{{totals.variances_dna}}</td>
        <td id="DnA-total-19" class="right-align-td">{{totals.var_ytd_dna}}</td>
      </tr>
      <script>
              function toggleborderDNA() {
          var fprTotalCells = document.querySelectorAll('[id^="DnA-total-"]');
          
          for (var i = 1; i <= 16; i++) {
            fprTotalCells[i - 1].classList.toggle("top-border");
          }
        }
      </script>

      <tr id="net-surplus-row1" class="net-surplus-ttl-1-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Net Surplus(Deficit)</strong></td>
        <td id="net-total-3" class=" right-align-td top-border" >{{totals.ammended_budget_netsurplus}}</td>
        <td id="net-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_netsurplus}}</td>
        <td id="net-total-5" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.09}}</td>
        <td id="net-total-6" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.10}}</td>
        <td id="net-total-7" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.11}}</td>
        <td id="net-total-8" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.12}}</td>
        <td id="net-total-9" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.01}}</td>
        <td id="net-total-10" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.02}}</td>
        <td id="net-total-11" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.03}}</td>
        <td id="net-total-12" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.04}}</td>
        <td id="net-total-13" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.05}}</td>
        <td id="net-total-14" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.06}}</td>
        <td id="net-total-15" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.07}}</td>
        <td id="net-total-16" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.08}}</td>
        <td id="net-total-17" class="right-align-td top-border">{{totals.ytd_netsurplus}}</td>
        <td id="net-total-18" class="right-align-td top-border">{{totals.variances_netsurplus}}</td>
        <td id="net-total-19" class="right-align-td">{{totals.var_netsurplus}}</td>
      </tr>

      <tr id="total-row1" class="ttl-1-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td><strong>Expense by Object Codes</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td  class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      {% for row in data_activities %}
      {% if row.Category == 'Payroll Costs' %}
      
      <tr id="row6-{{ forloop.counter }}" class="payroll-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td  class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td></td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6100' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn"> 
            <button id="row6" class="expand-button"  type="button" onclick="toggleRow(6); " style=" float: left;">+</button></td>
          <td class="collapsed"></td>
          <td>
            
            {{ row.obj }} - {{ row.Description }}
          </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
           {{row.budget}}
            
          </td>      
          <td  class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-5" >{{totals.total_EOC_pc.09}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-6" >{{totals.total_EOC_pc.10}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-7" >{{totals.total_EOC_pc.11}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-8" >{{totals.total_EOC_pc.12}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-9" >{{totals.total_EOC_pc.01}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-10">{{totals.total_EOC_pc.02}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-11">{{totals.total_EOC_pc.03}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-12">{{totals.total_EOC_pc.04}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-13">{{totals.total_EOC_pc.05}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-14">{{totals.total_EOC_pc.06}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-15">{{totals.total_EOC_pc.07}}</td>
          <td class="collapsed right-align-td" id="payroll-row-total-16">{{totals.total_EOC_pc.08}}</td>
          <td class="right-align-td">{{totals.ytd_EOC_pc}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_EOC}}</td>
      </tr>

      
    {% endif %}
      {%endfor%}


      <!-- END OF PAYROLL -->
      {% for row in data_activities %}
      {% if row.Category == 'Professional and Cont Svcs' %}
      
      <tr id="row7-{{ forloop.counter }}" class="PCS-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6200' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row7" class="expand-button"  type="button" onclick="toggleRow(7)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
            {{ row.obj }} - {{ row.Description }}
            </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td  class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td" id="pcs-total-5" >{{totals.total_EOC_pcs.09}}</td>
          <td class="collapsed right-align-td" id="pcs-total-6" >{{totals.total_EOC_pcs.10}}</td>
          <td class="collapsed right-align-td" id="pcs-total-7" >{{totals.total_EOC_pcs.11}}</td>
          <td class="collapsed right-align-td" id="pcs-total-8" >{{totals.total_EOC_pcs.12}}</td>
          <td class="collapsed right-align-td" id="pcs-total-9" >{{totals.total_EOC_pcs.01}}</td>
          <td class="collapsed right-align-td" id="pcs-total-10">{{totals.total_EOC_pcs.02}}</td>
          <td class="collapsed right-align-td" id="pcs-total-11">{{totals.total_EOC_pcs.03}}</td>
          <td class="collapsed right-align-td" id="pcs-total-12">{{totals.total_EOC_pcs.04}}</td>
          <td class="collapsed right-align-td" id="pcs-total-13">{{totals.total_EOC_pcs.05}}</td>
          <td class="collapsed right-align-td" id="pcs-total-14">{{totals.total_EOC_pcs.06}}</td>
          <td class="collapsed right-align-td" id="pcs-total-15">{{totals.total_EOC_pcs.07}}</td>
          <td class="collapsed right-align-td" id="pcs-total-16">{{totals.total_EOC_pcs.08}}</td>
          <td class="right-align-td">{{totals.ytd_EOC_pcs}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_EOC}}</td>
      </tr>
      
    
    {% endif %}
      {%endfor%}

      <!-- END OF Professional and Cont Svcs-->

      {% for row in data_activities %}
      {% if row.Category == 'Supplies and Materials' %}
      
      <tr id="row8-{{ forloop.counter }}" class="sm-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6300' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row8" class="expand-button"  type="button" onclick="toggleRow(8)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
            {{ row.obj }} - {{ row.Description }}
            </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td" id="sm-total-5" >{{totals.total_EOC_sm.09}}</td>
          <td class="collapsed right-align-td" id="sm-total-6" >{{totals.total_EOC_sm.10}}</td>
          <td class="collapsed right-align-td" id="sm-total-7" >{{totals.total_EOC_sm.11}}</td>
          <td class="collapsed right-align-td" id="sm-total-8" >{{totals.total_EOC_sm.12}}</td>
          <td class="collapsed right-align-td" id="sm-total-9" >{{totals.total_EOC_sm.01}}</td>
          <td class="collapsed right-align-td" id="sm-total-10">{{totals.total_EOC_sm.02}}</td>
          <td class="collapsed right-align-td" id="sm-total-11">{{totals.total_EOC_sm.03}}</td>
          <td class="collapsed right-align-td" id="sm-total-12">{{totals.total_EOC_sm.04}}</td>
          <td class="collapsed right-align-td" id="sm-total-13">{{totals.total_EOC_sm.05}}</td>
          <td class="collapsed right-align-td" id="sm-total-14">{{totals.total_EOC_sm.06}}</td>
          <td class="collapsed right-align-td" id="sm-total-15">{{totals.total_EOC_sm.07}}</td>
          <td class="collapsed right-align-td" id="sm-total-16">{{totals.total_EOC_sm.08}}</td>
          <td class="right-align-td">{{totals.ytd_EOC_sm}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_EOC}}</td>
      </tr>

      
    {% endif %}
      {%endfor%}

      <!-- END OF Supplies and Materials-->

      {% for row in data_activities %}
      {% if row.Category == 'Other Operating Expenses' %}
      
      <tr id="row9-{{ forloop.counter }}" class="ooe-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6400' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row9" class="expand-button"  type="button" onclick="toggleRow(9)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
            {{ row.obj }} - {{ row.Description }}
            </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td  class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td" id="ooe-total-5" >{{totals.total_EOC_ooe.09}}</td>
          <td class="collapsed right-align-td" id="ooe-total-6" >{{totals.total_EOC_ooe.10}}</td>
          <td class="collapsed right-align-td" id="ooe-total-7" >{{totals.total_EOC_ooe.11}}</td>
          <td class="collapsed right-align-td" id="ooe-total-8" >{{totals.total_EOC_ooe.12}}</td>
          <td class="collapsed right-align-td" id="ooe-total-9" >{{totals.total_EOC_ooe.01}}</td>
          <td class="collapsed right-align-td" id="ooe-total-10">{{totals.total_EOC_ooe.02}}</td>
          <td class="collapsed right-align-td" id="ooe-total-11">{{totals.total_EOC_ooe.03}}</td>
          <td class="collapsed right-align-td" id="ooe-total-12">{{totals.total_EOC_ooe.04}}</td>
          <td class="collapsed right-align-td" id="ooe-total-13">{{totals.total_EOC_ooe.05}}</td>
          <td class="collapsed right-align-td" id="ooe-total-14">{{totals.total_EOC_ooe.06}}</td>
          <td class="collapsed right-align-td" id="ooe-total-15">{{totals.total_EOC_ooe.07}}</td>
          <td class="collapsed right-align-td" id="ooe-total-16">{{totals.total_EOC_ooe.08}}</td>
          <td class="right-align-td">{{totals.ytd_EOC_ooe}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_EOC}}</td>
      </tr>

      
    {% endif %}
    {%endfor%}


            <!-- END OF Other Operating Expenses-->


      {% for row in data_activities %}
      {% if row.Category == 'Total Expense' %}
      
      <tr id="row10-{{ forloop.counter }}" class="expense-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"> </td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td">{{row.ytd_total}}</td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6500'%}
          <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row10" class="expand-button"  type="button" onclick="toggleRow(10)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
           {{ row.obj }} - {{ row.Description }}
            
          </td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
         
            {{totals.budget_for_6500}}
          
          </td>
          
          
          <td  class="right-align-td">{{totals.ytd_budget_for_6500}}</td>
          <td class="collapsed right-align-td" id="oe-total-5" >{{totals.total_EOC_te.09}}</td>
          <td class="collapsed right-align-td" id="oe-total-6" >{{totals.total_EOC_te.10}}</td>
          <td class="collapsed right-align-td" id="oe-total-7" >{{totals.total_EOC_te.11}}</td>
          <td class="collapsed right-align-td" id="oe-total-8" >{{totals.total_EOC_te.12}}</td>
          <td class="collapsed right-align-td" id="oe-total-9" >{{totals.total_EOC_te.01}}</td>
          <td class="collapsed right-align-td" id="oe-total-10">{{totals.total_EOC_te.02}}</td>
          <td class="collapsed right-align-td" id="oe-total-11">{{totals.total_EOC_te.03}}</td>
          <td class="collapsed right-align-td" id="oe-total-12">{{totals.total_EOC_te.04}}</td>
          <td class="collapsed right-align-td" id="oe-total-13">{{totals.total_EOC_te.05}}</td>
          <td class="collapsed right-align-td" id="oe-total-14">{{totals.total_EOC_te.06}}</td>
          <td class="collapsed right-align-td" id="oe-total-15">{{totals.total_EOC_te.07}}</td>
          <td class="collapsed right-align-td" id="oe-total-16">{{totals.total_EOC_te.08}}</td>
          <td class="right-align-td">{{totals.ytd_EOC_te}}</td>
          <td class="right-align-td">{{row.variances}}</td>
          <td class="right-align-td">{{row.var_EOC}}</td>
      </tr>

      
      {% endif %} 
      {%endfor%}
      <!-- END OF OPEARTING EXPENSE-->

     
     

      <tr id="" class="EOC-total-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Total Expense</strong></td>
        <td id="EOC-total-3" class=" right-align-td top-border" >{{totals.total_expense}}</td>
        <td id="EOC-total-4" class=" right-align-td top-border" >{{totals.total_expense_ytd_budget}}</td>
        <td id="EOC-total-5" class="collapsed right-align-td  top-border">{{totals.total_expense_months.09}}</td>
        <td id="EOC-total-6" class="collapsed right-align-td  top-border">{{totals.total_expense_months.10}}</td>
        <td id="EOC-total-7" class="collapsed right-align-td  top-border">{{totals.total_expense_months.11}}</td>
        <td id="EOC-total-8" class="collapsed right-align-td  top-border">{{totals.total_expense_months.12}}</td>
        <td id="EOC-total-9" class="collapsed right-align-td  top-border">{{totals.total_expense_months.01}}</td>
        <td id="EOC-total-10" class="collapsed right-align-td top-border">{{totals.total_expense_months.02}}</td>
        <td id="EOC-total-11" class="collapsed right-align-td top-border">{{totals.total_expense_months.03}}</td>
        <td id="EOC-total-12" class="collapsed right-align-td top-border">{{totals.total_expense_months.04}}</td>
        <td id="EOC-total-13" class="collapsed right-align-td top-border">{{totals.total_expense_months.05}}</td>
        <td id="EOC-total-14" class="collapsed right-align-td top-border">{{totals.total_expense_months.06}}</td>
        <td id="EOC-total-15" class="collapsed right-align-td top-border">{{totals.total_expense_months.07}}</td>
        <td id="EOC-total-16" class="collapsed right-align-td top-border">{{totals.total_expense_months.08}}</td>
        <td id="EOC-total-17" class="right-align-td top-border">{{totals.total_expense_ytd}}</td>
        <td id="EOC-total-18" class="right-align-td top-border">{{totals.variances_total_expense}}</td>
        <td id="EOC-total-19" class="right-align-td">{{totals.var_total_expense}}</td>
      </tr>

      <tr id="" class="netincome-total-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Net Income</strong></td>
        <td id="netincome-total-3" class=" right-align-td top-border" >{{totals.budget_net_income}}</td>
        <td id="netincome-total-4" class=" right-align-td top-border" >{{totals.ytd_budget_net_income}}</td>
        <td id="netincome-total-5" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.09}}</td>
        <td id="netincome-total-6" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.10}}</td>
        <td id="netincome-total-7" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.11}}</td>
        <td id="netincome-total-8" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.12}}</td>
        <td id="netincome-total-9" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.01}}</td>
        <td id="netincome-total-10" class="collapsed right-align-td top-border">{{totals.total_net_income_months.02}}</td>
        <td id="netincome-total-11" class="collapsed right-align-td top-border">{{totals.total_net_income_months.03}}</td>
        <td id="netincome-total-12" class="collapsed right-align-td top-border">{{totals.total_net_income_months.04}}</td>
        <td id="netincome-total-13" class="collapsed right-align-td top-border">{{totals.total_net_income_months.05}}</td>
        <td id="netincome-total-14" class="collapsed right-align-td top-border">{{totals.total_net_income_months.06}}</td>
        <td id="netincome-total-15" class="collapsed right-align-td top-border">{{totals.total_net_income_months.07}}</td>
        <td id="netincome-total-16" class="collapsed right-align-td top-border">{{totals.total_net_income_months.08}}</td>
        <td id="netincome-total-17" class="right-align-td top-border">{{totals.ytd_net_income}}</td>
        <td id="netincome-total-18" class="right-align-td top-border">{{totals.variances_net_income}}</td>
        <td id="netincome-total-19" class="right-align-td">{{totals.var_net_income}}</td>
      </tr>
      <script>

        document.addEventListener("DOMContentLoaded", function (){
          var missingColumns = []; 
          var today = new Date();
          var currentMonthIndex = today.getMonth();
          
      
          var monthNames = [
            "September", "October", "November", "December",
            "January", "February", "March", "April",
            "May", "June", "July", "August"
          ];
      
          
          for (var i = 6 + currentMonthIndex; i <= 17; i++) { 
              var columnCells = document.querySelectorAll(".local-revenue-row td:nth-child(" + i + "), .spr-row td:nth-child(" + i + "), .fpr-row td:nth-child(" + i + ")");
        
              var allEmpty = true;
        
              columnCells.forEach(function(cell) {
                  if (cell.innerText.trim()) {
                      allEmpty = false;
                  }
              });
        
              if (allEmpty) {
                missingColumns.push(monthNames[i-6 ]);
              }
          }
        
          if (missingColumns.length > 0) {
              var missingColumnsText = missingColumns.join(", ");
              var missingDataMessage = "The following columns have no data: " + missingColumnsText;
              document.getElementById("missingDataMessage").textContent = missingDataMessage;
              $('#missingDataModal').modal('show');
          }
        });
      </script>
      
      
      <script>
        function formatNumberWithCommas(number) {
          return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      }
      
      </script>
      {% else %} 




      <!-- START OF MANARA OR PREPPP-->
      <script>
        var last_month_number = parseInt("{{months.last_month_number}}", 10); // Parse it as an integer
         // Add 11 to it
         console.log(last_month_number)
         if (last_month_number <= 6) {
          last_month_number += 12;
          
      } 

        
        function hide17thColumn() {
          for (var i = last_month_number; i <= 17; i++) {
            var columnsToHide = document.querySelectorAll("th:nth-child(" + i + "), td:nth-child(" + i + ")");
        
            for (var j = 0; j < columnsToHide.length; j++) {
                columnsToHide[j].style.display = "none";
            }
        }
      }
      </script> 


      <tr class="header">
        <th class="firstcolumn" ></th>
        <th class="collapsed" ></th>
        <th ></th>
        <th style="text-align: center; "><div style="width: 100px;">Ammended <br>Budget          </div></th>
        <th style="text-align: center; "><div style="width: 100px;">{{months.format_ytd_budget}}% YTD <br>Budget</div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">July     </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">August   </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">September</div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">October  </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">November </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">December </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">January  </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">February </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">March    </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">April    </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">May      </div></th>
        <th class="collapsed" style="text-align: center;"><div style="width: 100px;">June     </div></th>

        <th style="text-align: center;"><div style="width: 100px;">Year-to-Date               </div></th>
        <th style="text-align: center;"><div style="width: 100px;">Variances                  </div></th>
        <th style="text-align: center;"><div style="width: 100px;">Var.({{months.format_ytd_budget}}%)</div></th>
      </tr>


      
      </thead>
  <tbody id="data-table-body">
      


     
  
      <!-- LOCAL REVENUE COLUMN START-->
    {% for row in data %}
      {% if row.category == 'Local Revenue' %}
          <tr id="row1-{{ forloop.counter }}" class="local-revenue-row">
              <td class="firstcolumn"><a href=" {% url 'delete' row.fund row.obj  %}"  style="display:none;"><i class="fas fa-times"></i></a></td>
       
              <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
              <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
              <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
                {% if row.total_budget == 0.0 %}
                    <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}"> 
                {% else %}
                    <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}">{{ row.total_budget }}
                {% endif %}
              </td>
         
              <td  class="right-align-td">{{row.ytd_budget}}</td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10}}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5}}</a></td>
              <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>

              <td class="right-align-td">{{ row.ytd_total }}</td>
              <td class="right-align-td"></td>
              <td class="right-align-td"></td>
          </tr>

          
          
          
      {% endif %}
    {% endfor %}
    
    
      
    

    
      <tr id="ttl-row" class="ttl-lr-row">
          <td class="firstcolumn">
            <button id="row1" class="expand-button"  type="button" onclick="toggleRow(1); toggleborderlr();" >+</button>
            
          </td>
          <td class="collapsed"></td>
          <td  ><strong>Local Revenue</strong></td>
          <td id="local-revenue-total-3" class=" right-align-td" >{{totals.total_ammended_lr }}</td>
          <td id="local-revenue-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_lr}}</td>
          <td id="local-revenue-total-15" class="collapsed right-align-td">{{ totals.total_lr.07 }}</td>
          <td id="local-revenue-total-16" class="collapsed right-align-td">{{ totals.total_lr.08 }}</td>
          <td id="local-revenue-total-5" class="collapsed right-align-td" >{{ totals.total_lr.09 }}</td>
          <td id="local-revenue-total-6" class="collapsed right-align-td" >{{ totals.total_lr.10 }}</td>
          <td id="local-revenue-total-7" class="collapsed right-align-td" >{{ totals.total_lr.11 }}</td>
          <td id="local-revenue-total-8" class="collapsed right-align-td" >{{ totals.total_lr.12 }}</td>
          <td id="local-revenue-total-9" class="collapsed right-align-td" >{{ totals.total_lr.01 }}</td>
          <td id="local-revenue-total-10" class="collapsed right-align-td">{{ totals.total_lr.02 }}</td>
          <td id="local-revenue-total-11" class="collapsed right-align-td">{{ totals.total_lr.03 }}</td>
          <td id="local-revenue-total-12" class="collapsed right-align-td">{{ totals.total_lr.04 }}</td>
          <td id="local-revenue-total-13" class="collapsed right-align-td">{{ totals.total_lr.05 }}</td>
          <td id="local-revenue-total-14" class="collapsed right-align-td">{{ totals.total_lr.06 }}</td>

          <td id="local-revenue-total-17" class="right-align-td ">{{totals.ytd_total_lr}}</td>
          <td id="local-revenue-total-18" class="right-align-td ">{{totals.variances_revenue_lr}}</td>
          <td id="local-revenue-total-19" class="right-align-td">{{totals.var_ytd_lr}}</td>

      </tr>
      <script>
        function toggleborderlr() {
          var fprTotalCells = document.querySelectorAll('[id^="local-revenue-total-"]');
          
          for (var i = 1; i <= 16; i++) {
            fprTotalCells[i - 1].classList.toggle("top-border");
          }
        }
      </script>

      <!-- STATE PROGRAM COLUMN START-->
      {% for row in data %}
      {% if row.category == 'State Program Revenue' %}
        <tr id="row2-{{ forloop.counter }}" class="spr-row">
          <td class="firstcolumn"></td>
          <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
          <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
          {% if row.total_budget == 0.0 %}
              <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}"> 
          {% else %}
              <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}">{{ row.total_budget }}
          {% endif %}
          </td>
  
          <td class="right-align-td">{{row.ytd_budget}}</td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>

          <td class="right-align-td">{{ row.ytd_total }}</td>
          <td class="right-align-td">{{ row.variances }}</td>
          <td class="right-align-td"></td>
      </tr>

    
      {% endif %}
      {% endfor %}


      


      <tr id="ttl-row" class="ttl-spr-row">
        <td class="firstcolumn">
          <button id="row2" class="expand-button" type="button" onclick="toggleRow(2); toggleborderspr();">+</button>
         
        </td>
        <td class="collapsed"></td>
        <td ><strong>State Program Revenue</strong></td>
        <td id="spr-total-3" class=" right-align-td" >{{ totals.total_ammended_spr }}</td>
        <td id="spr-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_spr}} </td>
        <td id="spr-total-15" class="collapsed right-align-td">{{ totals.total_spr.07 }}</td>
        <td id="spr-total-16" class="collapsed right-align-td">{{ totals.total_spr.08 }}</td>
        <td id="spr-total-5" class="collapsed right-align-td" >{{ totals.total_spr.09 }}</td>
        <td id="spr-total-6" class="collapsed right-align-td" >{{ totals.total_spr.10 }}</td>
        <td id="spr-total-7" class="collapsed right-align-td" >{{ totals.total_spr.11 }}</td>
        <td id="spr-total-8" class="collapsed right-align-td" >{{ totals.total_spr.12 }}</td>
        <td id="spr-total-9" class="collapsed right-align-td" >{{ totals.total_spr.01 }}</td>
        <td id="spr-total-10" class="collapsed right-align-td">{{ totals.total_spr.02 }}</td>
        <td id="spr-total-11" class="collapsed right-align-td">{{ totals.total_spr.03 }}</td>
        <td id="spr-total-12" class="collapsed right-align-td">{{ totals.total_spr.04 }}</td>
        <td id="spr-total-13" class="collapsed right-align-td">{{ totals.total_spr.05 }}</td>
        <td id="spr-total-14" class="collapsed right-align-td">{{ totals.total_spr.06 }}</td>

        <td id="spr-total-17" class="right-align-td ">{{totals.ytd_total_spr}}</td>
        <td id="spr-total-18" class="right-align-td ">{{totals.variances_revenue_spr}}</td>
        <td id="spr-total-19" class="right-align-td">{{totals.var_ytd_spr}}</td>
    </tr>
    <script>
      function toggleborderspr() {
        var fprTotalCells = document.querySelectorAll('[id^="spr-total-"]');
        
        for (var i = 1; i <= 16; i++) {
          fprTotalCells[i - 1].classList.toggle("top-border");
        }
      }
    </script>
    
    <!-- Federal Program Revenue COLUMN START-->
    {% for row in data %}
    {% if row.category == 'Federal Program Revenue' %}
    <tr id="row3-{{ forloop.counter }}" class="fpr-row">
        <td  class="firstcolumn"></td>
        <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
        <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
        {% if row.total_budget == 0.0 %}
          <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}"> 
        {% else %}
          <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.total_budget }}">{{ row.total_budget }}
        {% endif %}
        </td>
        
        <td class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>

        <td class="right-align-td">{{ row.ytd_total }}</td>
        <td class="right-align-td">{{ row.variances }}</td>
        <td class="right-align-td"></td>
    </tr>
   
        
    {% endif %}
    {% endfor %}



    <tr id="ttl-row" class="ttl-fpr-row">
      <td class="firstcolumn">
        <button id="row3" class="expand-button" type="button" onclick="toggleRow(3); toggleborderfpr(); " >+</button>
        
      </td>
      <td class="collapsed"></td>
      <td  ><strong>Federal Program Revenue</strong></td>
      <td id="fpr-total-3" class=" right-align-td" >{{totals.total_ammended_fpr }}</td>
      <td id="fpr-total-4" class=" right-align-td" >{{totals.ytd_ammended_total_fpr}}</td>
      <td id="fpr-total-15" class="collapsed right-align-td">{{ totals.total_fpr.07 }}</td>
      <td id="fpr-total-16" class="collapsed right-align-td">{{ totals.total_fpr.08 }}</td>
      <td id="fpr-total-5" class="collapsed right-align-td" >{{ totals.total_fpr.09 }}</td>
      <td id="fpr-total-6" class="collapsed right-align-td" >{{ totals.total_fpr.10 }}</td>
      <td id="fpr-total-7" class="collapsed right-align-td" >{{ totals.total_fpr.11 }}</td>
      <td id="fpr-total-8" class="collapsed right-align-td" >{{ totals.total_fpr.12 }}</td>
      <td id="fpr-total-9" class="collapsed right-align-td" >{{ totals.total_fpr.01 }}</td>
      <td id="fpr-total-10" class="collapsed right-align-td">{{ totals.total_fpr.02 }}</td>
      <td id="fpr-total-11" class="collapsed right-align-td">{{ totals.total_fpr.03 }}</td>
      <td id="fpr-total-12" class="collapsed right-align-td">{{ totals.total_fpr.04 }}</td>
      <td id="fpr-total-13" class="collapsed right-align-td">{{ totals.total_fpr.05 }}</td>
      <td id="fpr-total-14" class="collapsed right-align-td">{{ totals.total_fpr.06 }}</td>

      <td id="fpr-total-17" class="right-align-td ">{{totals.ytd_total_fpr}}</td>
      <td id="fpr-total-18" class="right-align-td ">{{totals.variances_revenue_fpr}}</td>
      <td id="fpr-total-19" class="right-align-td">{{totals.var_ytd_fpr}}</td>
    </tr>
    <script>
      function toggleborderfpr() {
        var fprTotalCells = document.querySelectorAll('[id^="fpr-total-"]');
        
        for (var i = 1; i <= 16; i++) {
          fprTotalCells[i - 1].classList.toggle("top-border");
        }
      }
    </script>
    

    <tr id="total-row" class="ttl-0-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td  ><strong>Total Revenue</strong></td>
      <td id="fpr-total-3" class=" right-align-td top-border" >{{ totals.total_ammended }}</td>
      <td id="fpr-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_total}}</td>
      <td id="fpr-total-15" class="collapsed right-align-td top-border">{{ totals.total_revenue.07 }}</td>
      <td id="fpr-total-16" class="collapsed right-align-td top-border">{{ totals.total_revenue.08 }}</td>
      <td id="fpr-total-5" class="collapsed right-align-td  top-border">{{ totals.total_revenue.09 }}</td>
      <td id="fpr-total-6" class="collapsed right-align-td  top-border">{{ totals.total_revenue.10 }}</td>
      <td id="fpr-total-7" class="collapsed right-align-td  top-border">{{ totals.total_revenue.11 }}</td>
      <td id="fpr-total-8" class="collapsed right-align-td  top-border">{{ totals.total_revenue.12 }}</td>
      <td id="fpr-total-9" class="collapsed right-align-td  top-border">{{ totals.total_revenue.01 }}</td>
      <td id="fpr-total-10" class="collapsed right-align-td top-border">{{ totals.total_revenue.02 }}</td>
      <td id="fpr-total-11" class="collapsed right-align-td top-border">{{ totals.total_revenue.03 }}</td>
      <td id="fpr-total-12" class="collapsed right-align-td top-border">{{ totals.total_revenue.04 }}</td>
      <td id="fpr-total-13" class="collapsed right-align-td top-border">{{ totals.total_revenue.05 }}</td>
      <td id="fpr-total-14" class="collapsed right-align-td top-border">{{ totals.total_revenue.06 }}</td>

      <td id="fpr-total-17" class="right-align-td top-border">{{totals.ytd_total_revenue}}</td>
      <td id="fpr-total-18" class="right-align-td top-border">{{totals.variances_revenue}}</td>
      <td id="fpr-total-19" class="right-align-td">{{totals.var_ytd}}</td>
    </tr>

  {% for row in data2 %}
  {% if row.category != 'Depreciation and Amortization' %}
    
    <tr id="row11-{{ forloop.counter }}" class="total-row1">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">{{ row.func_func }}-{{ row.desc }}</td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
          {% if row.budget == 0.0 or row.budget == None %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
          {% else %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{ row.budget }}
          {% endif %} 
        </td>
        
        
        <td  class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{ row.total_func7 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{ row.total_func8}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{ row.total_func9 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{ row.total_func10 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{ row.total_func11 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{ row.total_func12 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{ row.total_func1 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{ row.total_func2 }}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{ row.total_func3}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{ row.total_func4}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{ row.total_func5}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{ row.total_func6 }}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_ytd}}</td>
    </tr>
  {% endif %}
  {% endfor %}



    <tr id="total-row1" class="ttl-1-row">
      <td class="firstcolumn">
        
        <button id="row11" class="expand-button"  type="button" onclick="toggleRow(11); togglebordertotal1();" >-</button>
        
      </td>
      <td class="collapsed"></td>
      <td  ><strong>Total </strong></td>
      <td id="total1-3" class=" right-align-td top-border" >{{totals.first_total}}</td>
      <td id="total1-4" class=" right-align-td top-border" >{{totals.ytd_ammended_total_first}}</td>
      <td id="total1-15" class="collapsed right-align-td top-border">{{totals.first_total_months.07}}</td>
      <td id="total1-16" class="collapsed right-align-td top-border">{{totals.first_total_months.08}}</td>
      <td id="total1-5" class="collapsed right-align-td  top-border">{{totals.first_total_months.09}}</td>
      <td id="total1-6" class="collapsed right-align-td  top-border">{{totals.first_total_months.10}}</td>
      <td id="total1-7" class="collapsed right-align-td  top-border">{{totals.first_total_months.11}}</td>
      <td id="total1-8" class="collapsed right-align-td  top-border">{{totals.first_total_months.12}}</td>
      <td id="total1-9" class="collapsed right-align-td  top-border">{{totals.first_total_months.01}}</td>
      <td id="total1-10" class="collapsed right-align-td top-border">{{totals.first_total_months.02}}</td>
      <td id="total1-11" class="collapsed right-align-td top-border">{{totals.first_total_months.03}}</td>
      <td id="total1-12" class="collapsed right-align-td top-border">{{totals.first_total_months.04}}</td>
      <td id="total1-13" class="collapsed right-align-td top-border">{{totals.first_total_months.05}}</td>
      <td id="total1-14" class="collapsed right-align-td top-border">{{totals.first_total_months.06}}</td>

      <td id="total1-17" class="right-align-td top-border">{{totals.first_ytd_total}}</td>
      <td id="total1-18" class="right-align-td top-border">{{totals.variances_first_total}}</td>
      <td id="total1-19" class="right-align-td">{{totals.var_ytd_first_total}}</td>
    </tr>
    <script>
      function togglebordertotal1() {
        var fprTotalCells = document.querySelectorAll('[id^="total1-"]');
        
        for (var i = 1; i <= 16; i++) {
          fprTotalCells[i - 1].classList.toggle("top-border");
        }
      }
    </script>

    <tr id="surplus-row1" class="surplus-ttl-1-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td  ><strong>Surplus (Deficits) before Depreciation</strong></td>
      <td id="surplus-total-3" class=" right-align-td top-border" >{{totals.ammended_budget_SBD}}</td>
      <td id="surplus-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_SBD}}</td>
      <td id="surplus-total-15" class="collapsed right-align-td top-border">{{totals.total_SBD.07}}</td>
      <td id="surplus-total-16" class="collapsed right-align-td top-border">{{totals.total_SBD.08}}</td>
      <td id="surplus-total-5" class="collapsed right-align-td  top-border">{{totals.total_SBD.09}}</td>
      <td id="surplus-total-6" class="collapsed right-align-td  top-border">{{totals.total_SBD.10}}</td>
      <td id="surplus-total-7" class="collapsed right-align-td  top-border">{{totals.total_SBD.11}}</td>
      <td id="surplus-total-8" class="collapsed right-align-td  top-border">{{totals.total_SBD.12}}</td>
      <td id="surplus-total-9" class="collapsed right-align-td  top-border">{{totals.total_SBD.01}}</td>
      <td id="surplus-total-10" class="collapsed right-align-td top-border">{{totals.total_SBD.02}}</td>
      <td id="surplus-total-11" class="collapsed right-align-td top-border">{{totals.total_SBD.03}}</td>
      <td id="surplus-total-12" class="collapsed right-align-td top-border">{{totals.total_SBD.04}}</td>
      <td id="surplus-total-13" class="collapsed right-align-td top-border">{{totals.total_SBD.05}}</td>
      <td id="surplus-total-14" class="collapsed right-align-td top-border">{{totals.total_SBD.06}}</td>

      <td id="surplus-total-17" class="right-align-td top-border">{{totals.ytd_SBD}}</td>
      <td id="surplus-total-18" class="right-align-td top-border">{{totals.variances_SBD}}</td>
      <td id="surplus-total-19" class="right-align-td">{{totals.var_SBD}}</td>
    </tr>


    <!-- Depreciation and  amortization start -->

    {% for row in data2 %}
    {% if row.category == 'Depreciation and Amortization' %}
    
    <tr id="row12-{{ forloop.counter }}" class="DnA-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td style="white-space: nowrap;"><input type="hidden" class="form-control"  placeholder="Description" value="{{row.func_func}}">
          
          {{ row.func_func }} - {{ row.desc }}
          {{row.obj}}
        </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
          {% if row.budget == 0.0 or row.budget == None %}
          <input type="hidden" class="form-control" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
          {% else %}
          <input type="hidden" class="form-control"  placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
          {% endif %} 
        </td>
        
        
        <td  class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{row.total_func2_7}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{row.total_func2_8}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{row.total_func2_9}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{row.total_func2_10}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{row.total_func2_11}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{row.total_func2_12}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{row.total_func2_1}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{row.total_func2_2}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{row.total_func2_3}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{row.total_func2_4}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{row.total_func2_5}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{row.total_func2_6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_ytd}}</td>
    </tr>
    

    {% endif %}
  {% endfor %}


    <tr class="DnA-row-total">
      <td class="firstcolumn">
        <button id="row12" class="expand-button"  type="button" onclick="toggleRow(12); toggleborderDNA();" >-</button>
        
        
      </td>
      <td class="collapsed"></td>
      <td><strong>Depreciation and Amortization</strong></td>
      <td id="DnA-total-3" class=" right-align-td top-border" >{{totals.dna_total}}</td>
      <td id="DnA-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_dna}}</td>
      <td id="DnA-total-15" class="collapsed right-align-td top-border">{{totals.dna_total_months.07}}</td>
      <td id="DnA-total-16" class="collapsed right-align-td top-border">{{totals.dna_total_months.08}}</td>
      <td id="DnA-total-5" class="collapsed right-align-td  top-border">{{totals.dna_total_months.09}}</td>
      <td id="DnA-total-6" class="collapsed right-align-td  top-border">{{totals.dna_total_months.10}}</td>
      <td id="DnA-total-7" class="collapsed right-align-td  top-border">{{totals.dna_total_months.11}}</td>
      <td id="DnA-total-8" class="collapsed right-align-td  top-border">{{totals.dna_total_months.12}}</td>
      <td id="DnA-total-9" class="collapsed right-align-td  top-border">{{totals.dna_total_months.01}}</td>
      <td id="DnA-total-10" class="collapsed right-align-td top-border">{{totals.dna_total_months.02}}</td>
      <td id="DnA-total-11" class="collapsed right-align-td top-border">{{totals.dna_total_months.03}}</td>
      <td id="DnA-total-12" class="collapsed right-align-td top-border">{{totals.dna_total_months.04}}</td>
      <td id="DnA-total-13" class="collapsed right-align-td top-border">{{totals.dna_total_months.05}}</td>
      <td id="DnA-total-14" class="collapsed right-align-td top-border">{{totals.dna_total_months.06}}</td>

      <td id="DnA-total-17" class="right-align-td top-border">{{totals.dna_ytd_total}}</td>
      <td id="DnA-total-18" class="right-align-td top-border">{{totals.variances_dna}}</td>
      <td id="DnA-total-19" class="right-align-td">{{totals.var_ytd_dna}}</td>
    </tr>
    <script>
            function toggleborderDNA() {
        var fprTotalCells = document.querySelectorAll('[id^="DnA-total-"]');
        
        for (var i = 1; i <= 16; i++) {
          fprTotalCells[i - 1].classList.toggle("top-border");
        }
      }
    </script>

    <tr id="net-surplus-row1" class="net-surplus-ttl-1-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td  ><strong>Net Surplus(Deficit)</strong></td>
      <td id="net-total-3" class=" right-align-td top-border" >{{totals.ammended_budget_netsurplus}}</td>
      <td id="net-total-4" class=" right-align-td top-border" >{{totals.ytd_ammended_netsurplus}}</td>
      <td id="net-total-15" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.07}}</td>
      <td id="net-total-16" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.08}}</td>
      <td id="net-total-5" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.09}}</td>
      <td id="net-total-6" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.10}}</td>
      <td id="net-total-7" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.11}}</td>
      <td id="net-total-8" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.12}}</td>
      <td id="net-total-9" class="collapsed right-align-td  top-border">{{totals.total_netsurplus_months.01}}</td>
      <td id="net-total-10" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.02}}</td>
      <td id="net-total-11" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.03}}</td>
      <td id="net-total-12" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.04}}</td>
      <td id="net-total-13" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.05}}</td>
      <td id="net-total-14" class="collapsed right-align-td top-border">{{totals.total_netsurplus_months.06}}</td>

      <td id="net-total-17" class="right-align-td top-border">{{totals.ytd_netsurplus}}</td>
      <td id="net-total-18" class="right-align-td top-border">{{totals.variances_netsurplus}}</td>
      <td id="net-total-19" class="right-align-td">{{totals.var_netsurplus}}</td>
    </tr>

    <tr id="total-row1" class="ttl-1-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td><strong>Expense by Object Codes</strong></td>
      <script>
        for (var i = 3; i <= 19; i++) {
          if (i >= 5 && i <= 16) {
            document.write(`<td  class="collapsed right-align-td" ></td>`);
          } else {
            document.write(`<td  class=" right-align-td"></td>`);
          }
        }
      </script>
    </tr>

    {% for row in data_activities %}
    {% if row.Category == 'Payroll Costs' %}
    
    <tr id="row6-{{ forloop.counter }}" class="payroll-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
        <td></td>
        <td ></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td"></td>
        <td class="right-align-td"></td>
    </tr>
    {%endif%}
    {%endfor%}

    {% for row in data_expensebyobject %}
    {% if row.obj == '6100' %}
    
    <tr id="row5-{{ forloop.counter }}" class="EOC-row">
        <td class="firstcolumn"> 
          <button id="row6" class="expand-button"  type="button" onclick="toggleRow(6); " style=" float: left;">+</button></td>
        <td class="collapsed"></td>
        <td>
          
          {{ row.obj }} - {{ row.Description }}
        </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
         {{row.budget}}
          
        </td>      
        <td  class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-15">{{totals.total_EOC_pc.07}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-16">{{totals.total_EOC_pc.08}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-5" >{{totals.total_EOC_pc.09}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-6" >{{totals.total_EOC_pc.10}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-7" >{{totals.total_EOC_pc.11}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-8" >{{totals.total_EOC_pc.12}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-9" >{{totals.total_EOC_pc.01}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-10">{{totals.total_EOC_pc.02}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-11">{{totals.total_EOC_pc.03}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-12">{{totals.total_EOC_pc.04}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-13">{{totals.total_EOC_pc.05}}</td>
        <td class="collapsed right-align-td" id="payroll-row-total-14">{{totals.total_EOC_pc.06}}</td>

        <td class="right-align-td">{{totals.ytd_EOC_pc}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_EOC}}</td>
    </tr>

    
  {% endif %}
    {%endfor%}


    <!-- END OF PAYROLL -->
    {% for row in data_activities %}
    {% if row.Category == 'Professional and Cont Svcs' %}
    
    <tr id="row7-{{ forloop.counter }}" class="PCS-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
        <td class="right-align-td"></td>
        <td ></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td"></td>
        <td class="right-align-td"></td>
    </tr>
    
    {%endif%}
    {%endfor%}

    {% for row in data_expensebyobject %}
    {% if row.obj == '6200' %}
    
    <tr id="row5-{{ forloop.counter }}" class="EOC-row">
        <td class="firstcolumn">
          <button id="row7" class="expand-button"  type="button" onclick="toggleRow(7)" style=" float: left;">+</button>
        </td>
        <td class="collapsed"></td>
        <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
          {{ row.obj }} - {{ row.Description }}
          </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
          {% if row.budget == 0.0 or row.budget == None %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
          {% else %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
          {% endif %} 
        </td>
        
        
        <td  class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td" id="pcs-total-15">{{totals.total_EOC_pcs.07}}</td>
        <td class="collapsed right-align-td" id="pcs-total-16">{{totals.total_EOC_pcs.08}}</td>
        <td class="collapsed right-align-td" id="pcs-total-5" >{{totals.total_EOC_pcs.09}}</td>
        <td class="collapsed right-align-td" id="pcs-total-6" >{{totals.total_EOC_pcs.10}}</td>
        <td class="collapsed right-align-td" id="pcs-total-7" >{{totals.total_EOC_pcs.11}}</td>
        <td class="collapsed right-align-td" id="pcs-total-8" >{{totals.total_EOC_pcs.12}}</td>
        <td class="collapsed right-align-td" id="pcs-total-9" >{{totals.total_EOC_pcs.01}}</td>
        <td class="collapsed right-align-td" id="pcs-total-10">{{totals.total_EOC_pcs.02}}</td>
        <td class="collapsed right-align-td" id="pcs-total-11">{{totals.total_EOC_pcs.03}}</td>
        <td class="collapsed right-align-td" id="pcs-total-12">{{totals.total_EOC_pcs.04}}</td>
        <td class="collapsed right-align-td" id="pcs-total-13">{{totals.total_EOC_pcs.05}}</td>
        <td class="collapsed right-align-td" id="pcs-total-14">{{totals.total_EOC_pcs.06}}</td>

        <td class="right-align-td">{{totals.ytd_EOC_pcs}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_EOC}}</td>
    </tr>
    
  
  {% endif %}
    {%endfor%}

    <!-- END OF Professional and Cont Svcs-->

    {% for row in data_activities %}
    {% if row.Category == 'Supplies and Materials' %}
    
    <tr id="row8-{{ forloop.counter }}" class="sm-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
        <td class="right-align-td"></td>
        <td ></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td"></td>
        <td class="right-align-td"></td>
    </tr>
    {%endif%}
    {%endfor%}

    {% for row in data_expensebyobject %}
    {% if row.obj == '6300' %}
    
    <tr id="row5-{{ forloop.counter }}" class="EOC-row">
        <td class="firstcolumn">
          <button id="row8" class="expand-button"  type="button" onclick="toggleRow(8)" style=" float: left;">+</button>
        </td>
        <td class="collapsed"></td>
        <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
          {{ row.obj }} - {{ row.Description }}
          </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
          {% if row.budget == 0.0 or row.budget == None %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
          {% else %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
          {% endif %} 
        </td>
        
        
        <td class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td" id="sm-total-15">{{totals.total_EOC_sm.07}}</td>
        <td class="collapsed right-align-td" id="sm-total-16">{{totals.total_EOC_sm.08}}</td>
        <td class="collapsed right-align-td" id="sm-total-5" >{{totals.total_EOC_sm.09}}</td>
        <td class="collapsed right-align-td" id="sm-total-6" >{{totals.total_EOC_sm.10}}</td>
        <td class="collapsed right-align-td" id="sm-total-7" >{{totals.total_EOC_sm.11}}</td>
        <td class="collapsed right-align-td" id="sm-total-8" >{{totals.total_EOC_sm.12}}</td>
        <td class="collapsed right-align-td" id="sm-total-9" >{{totals.total_EOC_sm.01}}</td>
        <td class="collapsed right-align-td" id="sm-total-10">{{totals.total_EOC_sm.02}}</td>
        <td class="collapsed right-align-td" id="sm-total-11">{{totals.total_EOC_sm.03}}</td>
        <td class="collapsed right-align-td" id="sm-total-12">{{totals.total_EOC_sm.04}}</td>
        <td class="collapsed right-align-td" id="sm-total-13">{{totals.total_EOC_sm.05}}</td>
        <td class="collapsed right-align-td" id="sm-total-14">{{totals.total_EOC_sm.06}}</td>

        <td class="right-align-td">{{totals.ytd_EOC_sm}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_EOC}}</td>
    </tr>

    
  {% endif %}
    {%endfor%}

    <!-- END OF Supplies and Materials-->

    {% for row in data_activities %}
    {% if row.Category == 'Other Operating Expenses' %}
    
    <tr id="row9-{{ forloop.counter }}" class="ooe-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
        <td class="right-align-td"></td>
        <td ></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
        <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td"></td>
        <td class="right-align-td"></td>
    </tr>
    {%endif%}
    {%endfor%}

    {% for row in data_expensebyobject %}
    {% if row.obj == '6400' %}
    
    <tr id="row5-{{ forloop.counter }}" class="EOC-row">
        <td class="firstcolumn">
          <button id="row9" class="expand-button"  type="button" onclick="toggleRow(9)" style=" float: left;">+</button>
        </td>
        <td class="collapsed"></td>
        <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
          {{ row.obj }} - {{ row.Description }}
          </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
          {% if row.budget == 0.0 or row.budget == None %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
          {% else %}
          <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
          {% endif %} 
        </td>
        
        
        <td  class="right-align-td">{{row.ytd_budget}}</td>
        <td class="collapsed right-align-td" id="ooe-total-15">{{totals.total_EOC_ooe.07}}</td>
        <td class="collapsed right-align-td" id="ooe-total-16">{{totals.total_EOC_ooe.08}}</td>
        <td class="collapsed right-align-td" id="ooe-total-5" >{{totals.total_EOC_ooe.09}}</td>
        <td class="collapsed right-align-td" id="ooe-total-6" >{{totals.total_EOC_ooe.10}}</td>
        <td class="collapsed right-align-td" id="ooe-total-7" >{{totals.total_EOC_ooe.11}}</td>
        <td class="collapsed right-align-td" id="ooe-total-8" >{{totals.total_EOC_ooe.12}}</td>
        <td class="collapsed right-align-td" id="ooe-total-9" >{{totals.total_EOC_ooe.01}}</td>
        <td class="collapsed right-align-td" id="ooe-total-10">{{totals.total_EOC_ooe.02}}</td>
        <td class="collapsed right-align-td" id="ooe-total-11">{{totals.total_EOC_ooe.03}}</td>
        <td class="collapsed right-align-td" id="ooe-total-12">{{totals.total_EOC_ooe.04}}</td>
        <td class="collapsed right-align-td" id="ooe-total-13">{{totals.total_EOC_ooe.05}}</td>
        <td class="collapsed right-align-td" id="ooe-total-14">{{totals.total_EOC_ooe.06}}</td>

        <td class="right-align-td">{{totals.ytd_EOC_ooe}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_EOC}}</td>
    </tr>

    
  {% endif %}
  {%endfor%}


          <!-- END OF Other Operating Expenses-->


    {% for row in data_activities %}
    {% if row.Category == 'Total Expense' %}
    
    <tr id="row10-{{ forloop.counter }}" class="expense-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
        <td class="right-align-td"> </td>
        <td ></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities12}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
        <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>

        <td class="right-align-td">{{row.ytd_total}}</td>
        <td class="right-align-td"></td>
        <td class="right-align-td"></td>
    </tr>
    {%endif%}
    {%endfor%}

    {% for row in data_expensebyobject %}
    {% if row.obj == '6500'%}
        <tr id="row5-{{ forloop.counter }}" class="EOC-row">
        <td class="firstcolumn">
          <button id="row10" class="expand-button"  type="button" onclick="toggleRow(10)" style=" float: left;">+</button>
        </td>
        <td class="collapsed"></td>
        <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">
         {{ row.obj }} - {{ row.Description }}
          
        </td>
        <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
       
          {{totals.budget_for_6500}}
        
        </td>
        
        
        <td  class="right-align-td">{{totals.ytd_budget_for_6500}}</td>
        <td class="collapsed right-align-td" id="oe-total-15">{{totals.total_EOC_te.07}}</td>
        <td class="collapsed right-align-td" id="oe-total-16">{{totals.total_EOC_te.08}}</td>
        <td class="collapsed right-align-td" id="oe-total-5" >{{totals.total_EOC_te.09}}</td>
        <td class="collapsed right-align-td" id="oe-total-6" >{{totals.total_EOC_te.10}}</td>
        <td class="collapsed right-align-td" id="oe-total-7" >{{totals.total_EOC_te.11}}</td>
        <td class="collapsed right-align-td" id="oe-total-8" >{{totals.total_EOC_te.12}}</td>
        <td class="collapsed right-align-td" id="oe-total-9" >{{totals.total_EOC_te.01}}</td>
        <td class="collapsed right-align-td" id="oe-total-10">{{totals.total_EOC_te.02}}</td>
        <td class="collapsed right-align-td" id="oe-total-11">{{totals.total_EOC_te.03}}</td>
        <td class="collapsed right-align-td" id="oe-total-12">{{totals.total_EOC_te.04}}</td>
        <td class="collapsed right-align-td" id="oe-total-13">{{totals.total_EOC_te.05}}</td>
        <td class="collapsed right-align-td" id="oe-total-14">{{totals.total_EOC_te.06}}</td>

        <td class="right-align-td">{{totals.ytd_EOC_te}}</td>
        <td class="right-align-td">{{row.variances}}</td>
        <td class="right-align-td">{{row.var_EOC}}</td>
    </tr>

    
    {% endif %} 
    {%endfor%}
    <!-- END OF OPEARTING EXPENSE-->

   
   

    <tr id="" class="EOC-total-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td  ><strong>Total Expense</strong></td>
      <td id="EOC-total-3" class=" right-align-td top-border" >{{totals.total_expense}}</td>
      <td id="EOC-total-4" class=" right-align-td top-border" >{{totals.total_expense_ytd_budget}}</td>
      <td id="EOC-total-15" class="collapsed right-align-td top-border">{{totals.total_expense_months.07}}</td>
      <td id="EOC-total-16" class="collapsed right-align-td top-border">{{totals.total_expense_months.08}}</td>
      <td id="EOC-total-5" class="collapsed right-align-td  top-border">{{totals.total_expense_months.09}}</td>
      
      <td id="EOC-total-6" class="collapsed right-align-td  top-border">{{totals.total_expense_months.10}}</td>
      <td id="EOC-total-7" class="collapsed right-align-td  top-border">{{totals.total_expense_months.11}}</td>
      <td id="EOC-total-8" class="collapsed right-align-td  top-border">{{totals.total_expense_months.12}}</td>
      <td id="EOC-total-9" class="collapsed right-align-td  top-border">{{totals.total_expense_months.01}}</td>
      <td id="EOC-total-10" class="collapsed right-align-td top-border">{{totals.total_expense_months.02}}</td>
      <td id="EOC-total-11" class="collapsed right-align-td top-border">{{totals.total_expense_months.03}}</td>
      <td id="EOC-total-12" class="collapsed right-align-td top-border">{{totals.total_expense_months.04}}</td>
      <td id="EOC-total-13" class="collapsed right-align-td top-border">{{totals.total_expense_months.05}}</td>
      <td id="EOC-total-14" class="collapsed right-align-td top-border">{{totals.total_expense_months.06}}</td>

      <td id="EOC-total-17" class="right-align-td top-border">{{totals.total_expense_ytd}}</td>
      <td id="EOC-total-18" class="right-align-td top-border">{{totals.variances_total_expense}}</td>
      <td id="EOC-total-19" class="right-align-td">{{totals.var_total_expense}}</td>
    </tr>

    <tr id="" class="netincome-total-row">
      <td class="firstcolumn"></td>
      <td class="collapsed"></td>
      <td  ><strong>Net Income</strong></td>
      <td id="netincome-total-3" class=" right-align-td top-border" >{{totals.budget_net_income}}</td>
      <td id="netincome-total-4" class=" right-align-td top-border" >{{totals.ytd_budget_net_income}}</td>
      <td id="netincome-total-15" class="collapsed right-align-td top-border">{{totals.total_net_income_months.07}}</td>
      <td id="netincome-total-16" class="collapsed right-align-td top-border">{{totals.total_net_income_months.08}}</td>
      <td id="netincome-total-5" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.09}}</td>
      <td id="netincome-total-6" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.10}}</td>
      <td id="netincome-total-7" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.11}}</td>
      <td id="netincome-total-8" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.12}}</td>
      <td id="netincome-total-9" class="collapsed right-align-td  top-border">{{totals.total_net_income_months.01}}</td>
      <td id="netincome-total-10" class="collapsed right-align-td top-border">{{totals.total_net_income_months.02}}</td>
      <td id="netincome-total-11" class="collapsed right-align-td top-border">{{totals.total_net_income_months.03}}</td>
      <td id="netincome-total-12" class="collapsed right-align-td top-border">{{totals.total_net_income_months.04}}</td>
      <td id="netincome-total-13" class="collapsed right-align-td top-border">{{totals.total_net_income_months.05}}</td>
      <td id="netincome-total-14" class="collapsed right-align-td top-border">{{totals.total_net_income_months.06}}</td>

      <td id="netincome-total-17" class="right-align-td top-border">{{totals.ytd_net_income}}</td>
      <td id="netincome-total-18" class="right-align-td top-border">{{totals.variances_net_income}}</td>
      <td id="netincome-total-19" class="right-align-td">{{totals.var_net_income}}</td>
    </tr>

    {%endif%}


     
      

  


</tbody>
</table>
</form>
</div>


<div class="modal fade" id="missingDataModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Missing Data Columns</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p id="missingDataMessage">All Data Complete</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>




<script>
  document.addEventListener("DOMContentLoaded", function () {
    
   
    var modal = document.getElementById("myModal");

      
      var modalTableBody = document.getElementById("modal-table-body");

     
      function populateModal(data) {
     
        modalTableBody.innerHTML = "";
      
       
        data.gl_data.forEach(function (row) {
          var newRow = document.createElement("tr");
          newRow.innerHTML = `
            <td class="right-align-td">${row.fund}</td>
            <td class="right-align-td">${row.func}</td>
            <td class="right-align-td">${row.obj}</td>
            <td class="right-align-td">${row.org}</td>
            <td class="right-align-td">${row.fscl_yr}</td>
            <td class="right-align-td">${row.pgm}</td>
            <td class="right-align-td">${row.projDtl}</td>
            <td class="right-align-td">${row.AcctDescr}</td>
            <td class="right-align-td">${row.Number}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.Date}</td>
            <td class="right-align-td">${row.AcctPer}</td>
            <td class="right-align-td">${row.Real}</td>
            <td class="right-align-td">${row.Expend}</td>
            <td class="right-align-td">${row.Bal}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.WorkDescr}</td>
            <td class="right-align-td">${row.Type}</td>
            
          `;
          modalTableBody.appendChild(newRow);
        });
        var totalRow = document.createElement("tr");
        totalRow.innerHTML = `
          <td colspan="11" style="text-align: right;">Total Balance</td>
          <td>$${data.total_bal}</td>
          <td colspan="4"></td>
        `;
        modalTableBody.appendChild(totalRow);
      }

    
    function fetchDataAndPopulateModal(fund, obj, yr) {
      fetch(`/viewgl/${fund}/${obj}/${yr}/`)
        .then(function (response) {
          
          return response.json();
        })
        .then(function (data) {
          
          if (data.status === "success") {
          
            populateModal(data.data , data.total_bal);
        
            modal.style.display = "block";
          } else {
            console.error(data.message);
          }
        })
        .catch(function (error) {
          console.error("Error fetching data:", error);
        });
    }

    // Add click event listeners to all "a" elements inside the table
    var viewGLLinks = document.querySelectorAll(".viewgl-link");
    viewGLLinks.forEach(function (link) {
      link.addEventListener("click", function (event) {
        event.preventDefault();
        var fund = link.dataset.fund;
        var obj = link.dataset.obj;
        var yr = link.dataset.yr;
        fetchDataAndPopulateModal(fund, obj , yr);
      });
    });

    // Close the modal when the close button is clicked
    var closeButton = modal.querySelector(".modal-footer button");
    closeButton.addEventListener("click", function () {
      modal.style.display = "none";
    });
  });
</script>
{% endblock %}

{% block javascript %}
<script>
  var school = "{{ school }}"; 
</script>
<script src="{% static 'js/pl1.js' %}"></script>
<script src="{% static 'js/pl.js' %}"></script> 
<script src="{% static 'js/excel.js' %}"></script>

{% endblock %}

