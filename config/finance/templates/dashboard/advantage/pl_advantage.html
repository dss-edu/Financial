<!DOCTYPE html>
{% extends 'dashboard/advantage/base.html' %}
{% load static %}
<head>
  {% block stylesheet %}
  <style>

    th,
    td {
      width: 100px;
    }
   .firstcolumn
     {
      width: 0px;
    }

    .right-align-td {
      text-align: right;
    padding-right: 250px;
     
    }
    .collapsed {
      display: none;
 
  }
  
  .modal-body {
    max-height: 2000px;
    max-width: 2000px;
    overflow-y: auto;
  }
  
  .modal-body thead {
    position: sticky;
    top: 0;
    background-color: #f9f9f9;
    z-index: 1;
  }
  

  .modal-footer {
    z-index: 2;
  }

  .table-container {

    bottom: 0;
    width: 100%;
    max-height: calc(100vh - 150px); 
    overflow: auto;
    position: relative;
  }
  .header {
    position: sticky;
    top: 0;
    z-index: 2;

    background-color: white !important; 
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
  }
  td:nth-child(2) {
    width: 0px;
    text-align: right; /* Adjust text alignment */
     /* Adjust font size */
    line-height: 1; /* Adjust line height */
    white-space: nowrap; /* Prevent text wrapping */
  }
  
  .table th,
  .table td {
    padding: 0.2rem !important;

  }

  

  
</style>
  {% endblock %}

</head>
{% block body %}

 <div id="content-wrapper">
  
  <nav class="navbar navbar-expand navbar-dark bg-dark ">

    <a class="navbar-brand mr-1 text-primary " href="" ></a>
    

    <!-- Navbar Search -->
    <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
      
    </form>
    <a class="navbar-brand mr-1 text-primary " href="https://app.powerbi.com/groups/031634b4-01f7-4358-856c-e48f6f5fcaca/reports/fd891db5-908a-4463-9807-eece4c2c2f76/ReportSection6c18d619620bd9b8337e?experience=power-bi" data-toggle="tooltip" title="view in powerbi" target="_blank"><i class="fas fa-file-powerpoint"  ></i></a>
    <!-- Navbar -->
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <a class="navbar-brand mr-1 text-primary " href="{% url 'pl_advantagechart' %}" data-toggle="tooltip" title="view as chart"><i class="fas fa-chart-bar" ></i></a>
    
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <a id="export-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="export to pdf"><i class="fas fa-file-pdf"></i></a>
        &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <a id="export-excel2-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="export to excel"><i class="fas fa-file-excel"></i></a>
  </nav>
   <script>
  document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('export-excel2-button').addEventListener('click', function() {
          generateExcel();
      });
  
      function generateExcel() {
         
          $('#spinner-modal').modal('show');
          fetch('{% url "generate_excel" %}')
              .then(function(response) {
                  return response.blob();
              })
              .then(function(blob) {
                  const url = window.URL.createObjectURL(blob);
                  const a = document.createElement('a');
                  a.style.display = 'none';
                  a.href = url;
                  a.download = 'GeneratedExcel.xlsx'; // Change the filename as needed
                  document.body.appendChild(a);
                  a.click();
                  window.URL.revokeObjectURL(url);
              })
              .catch(function(error) {
                  console.error('Error generating Excel:', error);
              }).finally(function (){
                $('#spinner-modal').modal('hide');
              });
      }
  });
  </script>

  <script>
      document.getElementById('export-pdf-button').addEventListener('click', function (event) {
      event.preventDefault(); 

        // Show the confirmation modal
      var confirmationModal = document.getElementById("confirmation-modal");
      var confirmYes = document.getElementById("confirm-yes");
      var confirmNo = document.getElementById("confirm-no");

      
      confirmYes.addEventListener("click", function () {
        var element = document.getElementById('data-table');
      var rows = element.getElementsByTagName('tr');
      for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName('td');
        var headerCells = rows[i].getElementsByTagName('th');

        if (cells.length > 0) {
          rows[i].removeChild(cells[0]);
          
        }

        if (headerCells.length > 0) {
          rows[i].removeChild(headerCells[0]);
          
        }

      }

      
      expandColumns();
      for (var rowId = 1; rowId <= 100; rowId++) {
        expandRow(rowId);
      }

      var options = {
        margin: 2,
        filename: 'exported_table.pdf',
        image: { type: 'png', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: [700,700], orientation: 'portrait' },
      };

      confirmationModal.style.display = "none";

      $('#spinner-modal').modal('show');
      html2pdf().set(options).from(element).outputPdf().then(function(pdf){
          $('#spinner-modal').modal('hide');
      }).save();
      
      });

      confirmNo.addEventListener("click", function () {
        var element = document.getElementById('data-table');
        hideRowsOnLoad();
              var rows = element.getElementsByTagName('tr');
      for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName('td');
        var headerCells = rows[i].getElementsByTagName('th');

        if (cells.length > 0) {
          rows[i].removeChild(cells[0]);
          
        }

        if (headerCells.length > 0) {
          rows[i].removeChild(headerCells[0]);
          
        }

      }

        var options = {
          margin: 2,
          filename: 'exported_table.pdf',
          image: { type: 'png', quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'mm', format: [700,700], orientation: 'portrait' },
        };

      $('#spinner-modal').modal('show');
      html2pdf().set(options).from(element).outputPdf().then(function(pdf){
          $('#spinner-modal').modal('hide');
      }).save();
        
      confirmationModal.style.display = "none";

      });
      
      confirmationModal.style.display = "block";
    });

    function expandRow(rowId) {
      for (var i = 0; i <= 100; i++) {
        var row = document.getElementById("row" + rowId + "-" + i);
        if (row) {
          row.style.display = "table-row";
        }
      }
    }

    function expandColumns() {
      var collapsedColumns = document.getElementsByClassName("collapsed");
      for (var i = 0; i < collapsedColumns.length; i++) {
        collapsedColumns[i].style.display = "table-cell";
      }
    }


  </script>


  <div class="modal" id="confirmation-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content" style="height: 80%;">

        <div class="modal-body">
           <h4>Export Confirmation</h4>
          <p>Do you want the detailed view?</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="confirm-yes" class="btn btn-primary">Yes</button>
          <button type="button" id="confirm-no" class="btn btn-secondary" data-dismiss="modal">No</button>
        </div>
      </div>
    </div>
  </div>

    <div class="modal" id="spinner-modal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-dialog-centered d-flex justify-content-center align-items-center" role="document">
            <div class="modal-content  p-0 w-auto h-auto">
                <div class="modal-body text-center">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End of spinner modal -->


<div class="modal" id="myModal">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
       
        <table class="table table-hover" id="balancesheet-data-table1">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
            <th>Real</th>
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
            
            </tr>
          </thead>
          <tbody id="modal-table-body">
      
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal1-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></a>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="export-excel-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="EXCEL"><i class="fas fa-file-excel"></i></a>
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('exportmodal1-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table1');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>

<script>

  document.getElementById('export-excel-button').addEventListener('click', function (event) {
    event.preventDefault(); 
 
  var table = document.getElementById("balancesheet-data-table1"); // Use the table containing the headers

  
  var wb = XLSX.utils.book_new();

  var ws = XLSX.utils.table_to_sheet(table);

  XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

 
  var wbout = XLSX.write(wb, { bookType: "xlsx", type: "array" });

  var blob = new Blob([wbout], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });

  
  var link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "data.xlsx";
  link.click();
});

</script>

<div class="modal" id="myModal2">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
        <!-- Modify the table to display the data from the viewgl function -->
        <table class="table table-hover" id="balancesheet-data-table2">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
           
            <th>Real</th>
       
           
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
         
            </tr>
          </thead>
          <tbody id="modal2-table-body">
            <!-- The data from the viewgl function will be populated here -->
          </tbody>
        </table>
      </div>
      <div class="modal2-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal2-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></i></a>
        
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('exportmodal2-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table2');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>


<div class="modal" id="myModal3">
  <div class="modal-dialog modal-dialog-centered" style="width: 80%; height: 80%; max-width: none; max-height: none;">
    <div class="modal-content" style="height: 80%;">
      <div class="modal-body" style="max-height: 80%; overflow-y: auto;">
        <!-- Modify the table to display the data from the viewgl function -->
        <table class="table table-hover" id="balancesheet-data-table3">
          <thead>
            <tr>
            <th>fund</th>
            <th>func</th>
            <th>obj</th>
            <th>org</th>
            <th>fscl_yr</th>
            <th>pgm</th>
            
            <th>projDtl</th>
            <th>AcctDescr</th>
            <th>Number</th>
            <th>Date</th>
            <th>AcctPer</th>
           
            <th>Real</th>
       
           
            <th>Expend</th>
            <th>Bal</th>
            <th>WorkDescr</th>
            <th>Type</th>
         
            </tr>
          </thead>
          <tbody id="modal3-table-body">
            <!-- The data from the viewgl function will be populated here -->
          </tbody>
        </table>
      </div>
      <div class="modal3-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a id="exportmodal3-pdf-button" class="navbar-brand mr-1 text-primary " href="#" data-toggle="tooltip" title="PDF"><i class="fas fa-file-pdf"></i></i></a>
        
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('exportmodal3-pdf-button').addEventListener('click', function (event) {
    event.preventDefault(); 

    var element = document.getElementById('balancesheet-data-table3');

    
    var options = {
      margin: 2,
      filename: 'exported_table.pdf',
      image: { type: 'png', quality: 0.98 },
      html2canvas: {  scale: 1, 
        scrollX: 0,
        scrollY: 0,},
      jsPDF: { unit: 'mm', format: [600,600], orientation: 'portrait' },
    };

   
    html2pdf().set(options).from(element).save();
  });
</script>

<div class="table-container"  >
<form  id="insert-row-form" action="{% url 'insert-row' %}" method="POST">
 
  <div id="edit-container" >
    <button id="edit-button" class="btn btn-sm btn-success" type="button" style=" float: right;">Edit</button>
</div>

<div id="cancel-container" style="display: none;"> 
  <button id="cancel-button" class="btn btn-sm btn-success" type="button" style=" float: right; margin-left: 10px;" >Cancel</button>
</div>

<div id="save-container" style="display: none; ">
    <button id="save-button" class="btn btn-sm btn-success" style="float: right; margin-left: 10px; " >Save</button>
</div>


<script>
    document.getElementById("edit-button").addEventListener("click", function() {
        // Hide the "Edit" container
        document.getElementById("edit-container").style.display = "none";

        // Show the "Save" container
        document.getElementById("save-container").style.display = "block";
        document.getElementById("cancel-container").style.display = "block";
        
        
        
        var valueCells = document.querySelectorAll("[id^='value-cell-']");
        valueCells.forEach(function(cell) {
            cell.contentEditable = "true";
        });

       
 
        
        
    });

    document.getElementById("cancel-button").addEventListener("click", function() {
        // Hide the "Save" container
        
        document.getElementById("save-container").style.display = "none";
        document.getElementById("cancel-container").style.display = "none";
       

        

        // Show the "Edit" container
        document.getElementById("edit-container").style.display = "block";
        var valueCells = document.querySelectorAll("[id^='value-cell-']");
        valueCells.forEach(function(cell) {
            cell.contentEditable = "false";
        });

       
     
       
        
    });
</script>

  {% csrf_token %}
    <table id="data-table" class="table table-hover">
        <thead>
          <tr>
            <th class="firstcolumn"></th>
            <th class="collapsed"></th>
          
            <th colspan="17" style="white-space: nowrap;">
              <h2 style="text-align: center;">ADVANTAGE ACADEMY</h2><br>
              <h2 style="text-align: center;">FY2022-2023 Statement of Activities as of {{last_month}}</h2><br>
            </th>

            
        </tr>
        <tr>
          <script>
            for (var i = 0; i <= 18; i++){
              if (i === 0){
                document.write(`<td  class="firstcolumn"></td>`);

              }
              else if (i === 1){
                document.write(`<td  class="collapsed"></td>`);

              }
              else if (i === 5 ) {
                document.write(`<th><button id="toggle-button" type="button" class="expand-button" onclick="toggleColumns(); hide17thColumn();" >+</button></th>`);
              }
              else if(i>=6 && i<=16){
                document.write(`<td  class="collapsed"></td>`);
              }
              else{
                document.write(`<td  ></td>`);
              }
            }
            
          </script>
        </tr>
        <script>
          function hide17thColumn() {
            var columnsToHide = document.querySelectorAll("th:nth-child(17), td:nth-child(17) ");
        
            for (var i = 0; i < columnsToHide.length; i++) {
                columnsToHide[i].style.display = "none";
            }
        }
        </script>

        
        </thead>
    <tbody id="data-table-body">
        <tr class="header">
            <th class="firstcolumn"></th>
            <th class="collapsed"></th>
            <th></th>
            <th style="text-align: center; " >Ammended Budget </th>
            <th style="text-align: center;">{{format_ytd_budget}}% YTD Budget </th>
            <th class="collapsed"  style="text-align: center;">September</th>
            <th class="collapsed"  style="text-align: center;">October</th>
            <th class="collapsed"  style="text-align: center;">November</th>
            <th class="collapsed"  style="text-align: center;">December</th>
            <th class="collapsed"  style="text-align: center;">January</th>
            <th class="collapsed"  style="text-align: center;">February</th>
            <th class="collapsed"  style="text-align: center;">March</th>
            <th class="collapsed"  style="text-align: center;">April</th>
            <th class="collapsed"  style="text-align: center;">May</th>
            <th class="collapsed"  style="text-align: center;">June</th>
            <th class="collapsed"  style="text-align: center;">July</th>
            <th class="collapsed"  style="text-align: center;">August</th>
            <th style="text-align: center;">Year to Date</th>
            <th style="text-align: center;">Variances</th>
            <th style="text-align: center;">Var.({{format_ytd_budget}}%)</th>
        </tr>
       
    
        <!-- LOCAL REVENUE COLUMN START-->
      {% for row in data %}
        {% if row.category == 'Local Revenue' %}
            <tr id="row1-{{ forloop.counter }}" class="local-revenue-row">
                <td class="firstcolumn"><a href=" {% url 'delete' row.fund row.obj  %}"  style="display:none;"><i class="fas fa-times"></i></a></td>
         
                <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
                <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
                <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
                  {% if row.value == 0.0 %}
                      <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}"> 
                  {% else %}
                      <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}">{{ row.value }}
                  {% endif %}
                </td>
           
                <td id="convertLR{{ forloop.counter }}" class="right-align-td"></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10}}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5}}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
                <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
                <td class="right-align-td"></td>
                <td class="right-align-td"></td>
                <td class="right-align-td"></td>
            </tr>
            <script>
              function convertValue1(rowNumber, value) {
                if (isNaN(value)) {
                  document.getElementById("convertLR" + rowNumber).innerHTML = '';
                  return;
                }
                var convertedBudget1 = (value * {{ytd_budget}} ).toFixed(0);
                var formattedBudget1 = Number(convertedBudget1).toLocaleString();
                document.getElementById("convertLR" + rowNumber).innerHTML = formattedBudget1;
            }
            
            var rowValue = "{{ row.value }}";
            var formatrowValue = parseFloat(rowValue.replace(/,/g, ''));
            if (formatrowValue !== 0.0) {
                convertValue1({{ forloop.counter }}, formatrowValue);
            }
            
            
            document.getElementById("row1-{{ forloop.counter }}").addEventListener("input", function(e) {
                var newValue = parseFloat(e.target.innerText);
                if (!isNaN(newValue)) {
                    convertValue1({{ forloop.counter }}, newValue);
                }
            });
            </script>
            
            
            
        {% endif %}
      {% endfor %}
      
      
        
      

      
        <tr id="ttl-row" class="ttl-lr-row">
            <td class="firstcolumn">
              <button id="row1" class="expand-button"  type="button" onclick="toggleRow(1)" >+</button>
              
            </td>
            <td class="collapsed"></td>
            <td  ><strong>Local Revenue</strong></td>
            <script>
              for (var i = 3; i <= 19; i++) {
                if (i >= 5 && i <= 16) {
                  document.write(`<td id="local-revenue-total-${i}" class="collapsed right-align-td" ></td>`);
                } else {
                  document.write(`<td id="local-revenue-total-${i}" class="right-align-td"></td>`);
                }
              }
            </script>
        </tr>

        <!-- STATE PROGRAM COLUMN START-->
        {% for row in data %}
        {% if row.category == 'State Program Revenue' %}
          <tr id="row2-{{ forloop.counter }}" class="spr-row">
            <td class="firstcolumn"></td>
            <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
            <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
            <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
            {% if row.value == 0.0 %}
                <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}"> 
            {% else %}
                <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}">{{ row.value }}
            {% endif %}
            </td>
    
            <td id="convertSPR{{ forloop.counter }}" class="right-align-td">></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7}}</a></td>
            <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
            <td class="right-align-td"></td>
            <td class="right-align-td"></td>
            <td class="right-align-td"></td>
        </tr>
        <script>
          function convertValue2(rowNumber, value) {
            if (isNaN(value)) {
              document.getElementById("convertSPR" + rowNumber).innerHTML = '';
              return;
            }
            var convertedBudget2 = (value * {{ytd_budget}}).toFixed(0);
            var formattedBudget2 = Number(convertedBudget2).toLocaleString();
            document.getElementById("convertSPR" + rowNumber).innerHTML = formattedBudget2;
          }

          var rowValue = "{{ row.value }}";
          var formatrowValue = parseFloat(rowValue.replace(/,/g, ''));
          if (formatrowValue !== 0.0) {
              convertValue2({{ forloop.counter }}, formatrowValue);
          }

          
          document.getElementById("row2-{{ forloop.counter }}").addEventListener("input", function(e) {
              var newValue = parseFloat(e.target.innerText);
              if (!isNaN(newValue)) {
                  convertValue2({{ forloop.counter }}, newValue);
              }
          });
      </script>
      
        {% endif %}
        {% endfor %}


        


        <tr id="ttl-row" class="ttl-spr-row">
          <td class="firstcolumn">
            <button id="row2" class="expand-button" type="button" onclick="toggleRow(2)">+</button>
           
          </td>
          <td class="collapsed"></td>
          <td  ><strong>State Program Revenue</strong></td>
          <script>
            for (var i = 3; i <= 19; i++) {
              if (i >= 5 && i <= 16) {
                document.write(`<td id="spr-total-${i}" class="collapsed right-align-td"" ></td>`);
              } else {
                document.write(`<td id="spr-total-${i}"  class="right-align-td"></td>`);
              }
            }
          </script>
      </tr>
      
      <!-- Federal Program Revenue COLUMN START-->
      {% for row in data %}
      {% if row.category == 'Federal Program Revenue' %}
      <tr id="row3-{{ forloop.counter }}" class="fpr-row">
          <td  class="firstcolumn"></td>
          <td class=" collapsed" ><input type="hidden" class="form-control" name="updatefund[]" placeholder="Description" value="{{row.fund}}">{{row.fund}}</td>
          <td><input type="hidden" class="form-control" name="updateobj[]" placeholder="Description" value="{{row.obj}}">{{ row.obj }} - {{ row.description }}</td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false"  class="right-align-td">
          {% if row.value == 0.0 %}
            <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}"> 
          {% else %}
            <input type="hidden" class="form-control" id="updatevalue-{{ forloop.counter }}" name="updatevalue[]" placeholder="Description"  value="{{ row.value }}">{{ row.value }}
          {% endif %}
          </td>
          
          <td id="convertFPR{{ forloop.counter }}" class="right-align-td"></td>
          
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="09">{{ row.total_real9 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="10">{{ row.total_real10 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="11">{{ row.total_real11 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="12">{{ row.total_real12 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="01">{{ row.total_real1 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="02">{{ row.total_real2 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="03">{{ row.total_real3 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="04">{{ row.total_real4 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="05">{{ row.total_real5 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="06">{{ row.total_real6 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="07">{{ row.total_real7 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewgl-link" data-fund="{{ row.fund }}" data-obj="{{ row.obj }}" data-yr="08">{{ row.total_real8 }}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
            <script>
              function convertValue(rowNumber, value) {
                if (isNaN(value)) {
                  document.getElementById("convertFPR" + rowNumber).innerHTML = '';
                  return;
                }
                  var convertedBudget = (value * {{ytd_budget}}).toFixed(0);
                  var formattedbudget = Number(convertedBudget).toLocaleString();
                  document.getElementById("convertFPR" + rowNumber).innerHTML = formattedbudget;
              }
  
              var rowValue = "{{ row.value }}";
              var formatrowValue = parseFloat(rowValue.replace(/,/g, ''));
              if (formatrowValue !== 0.0) {
                  convertValue({{ forloop.counter }}, formatrowValue);
              }
  
              
              document.getElementById("row3-{{ forloop.counter }}").addEventListener("input", function(e) {
                  var newValue = parseFloat(e.target.innerText);
                  if (!isNaN(newValue)) {
                      convertValue({{ forloop.counter }}, newValue);
                  }
              });
          </script>
          
      {% endif %}
      {% endfor %}



      <tr id="ttl-row" class="ttl-fpr-row">
        <td class="firstcolumn">
          <button id="row3" class="expand-button" type="button" onclick="toggleRow(3)" >+</button>
          
        </td>
        <td class="collapsed"></td>
        <td  ><strong>Federal Program Revenue</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td id="fpr-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="fpr-total-${i}" class="right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      <tr id="total-row" class="ttl-0-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Total Revenue</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="total-${i}" class="right-align-td"></td>`);
            }
          }
        </script>
      </tr>

    {% for row in data2 %}
      
      <tr id="row11-{{ forloop.counter }}" class="total-row1">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}">{{ row.func_func }}-{{ row.desc }}</td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{ row.budget }}
            {% endif %} 
          </td>
          
          
          <td id="convertFunc{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{ row.total_func9 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{ row.total_func10 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{ row.total_func11 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{ row.total_func12 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{ row.total_func1 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{ row.total_func2 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{ row.total_func3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{ row.total_func4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{ row.total_func5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{ row.total_func6 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{ row.total_func7 }}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{ row.total_func8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      

      
      
      
    {% endfor %}



      <tr id="total-row1" class="ttl-1-row">
        <td class="firstcolumn">
          
          <button id="row11" class="expand-button"  type="button" onclick="toggleRow(11)" >+</button>
          
        </td>
        <td class="collapsed"></td>
        <td  ><strong>Total </strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="total1-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="total1-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      <tr id="surplus-row1" class="surplus-ttl-1-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Surplus (Deficits) before Depreciation</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="surplus-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="surplus-total-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>


      <!-- Depreciation and  amortization start -->

      {% for row in data2 %}
      
      <tr id="row12-{{ forloop.counter }}" class="DnA-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td style="white-space: nowrap;"><input type="hidden" class="form-control"  placeholder="Description" value="{{row.func_func}}">
            <div class="row">
            <div class="col">{{ row.func_func }} - {{ row.desc }}</div>
            <div class="col" style="text-align:right;">6449</div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control"  placeholder="Description"  value="{{ row.budget }}">
            {% endif %} 
          </td>
          
          
          <td id="convertFunc{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="09">{{row.total_func2_9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="10">{{row.total_func2_10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="11">{{row.total_func2_11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="12">{{row.total_func2_12}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="01">{{row.total_func2_1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="02">{{row.total_func2_2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="03">{{row.total_func2_3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="04">{{row.total_func2_4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="05">{{row.total_func2_5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="06">{{row.total_func2_6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="07">{{row.total_func2_7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglfunc-link" data-func="{{ row.func_func }}"  data-yr="08">{{row.total_func2_8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      

      
      
      
    {% endfor %}


      <tr >
        <td class="firstcolumn">
          <button id="row12" class="expand-button"  type="button" onclick="toggleRow(12)" >+</button>
          <button id="add-row-func-button" class="btn btn-success" type="button" onclick="addNewRowFunc()" style="display:none;" >+</button>
          
        </td>
        <td class="collapsed"></td>
        <td><strong>Depreciation and Amortization</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="DnA-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="DnA-total-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      <tr >
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Net Surplus(Deficit)</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="net-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="net-total-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>
      <tr id="total-row1" class="ttl-1-row">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td><strong>Expense by Object Codes</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="total1-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="total1-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      {% for row in data_activities %}
      {% if row.Category == 'Payroll Costs' %}
      
      <tr id="row6-{{ forloop.counter }}" class="payroll-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td  class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td></td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6100' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn"> 
            <button id="row6" class="expand-button"  type="button" onclick="toggleRow(6)" style=" float: left;">+</button></td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}"><div class="row">
            <div class="col">{{ row.obj }} - {{ row.Description }}</div>
            <div class="col"></div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td id="convertExpense{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td" id="payroll-row-total-5" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-6" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-7" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-8" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-9" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-10"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-11"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-12"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-13"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-14"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-15"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07"></a></td>
          <td class="collapsed right-align-td" id="payroll-row-total-16"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08"></a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>

      <script>
        function convertExpense(rowNumber, value) {
            if (isNaN(value)) {
                document.getElementById("convertExpense" + rowNumber).innerHTML = '';
                return;
            }
    
            var convertedBudget = (value * {{ytd_budget}}).toFixed(0);
            var formattedBudget = Number(convertedBudget).toLocaleString();
            document.getElementById("convertExpense" + rowNumber).innerHTML = formattedBudget;
        }
    
        var rowBudget = "{{ row.budget }}";
        var rowValue = parseFloat(rowBudget.replace(/,/g, ''));
        
        if (!isNaN(rowValue)) {
          convertExpense({{ forloop.counter }}, rowValue);
        }
    
        document.getElementById("row5-{{ forloop.counter }}").addEventListener("input", function(e) {
            var newValue = parseFloat(e.target.innerText.replace(/,/g, ''));
            if (!isNaN(newValue)) {
                convertValue({{ forloop.counter }}, newValue);
            }
        });
    </script>
    {% endif %}
      {%endfor%}

      <!-- END OF PAYROLL -->
      {% for row in data_activities %}
      {% if row.Category == 'Professional and Cont Svcs' %}
      
      <tr id="row7-{{ forloop.counter }}" class="PCS-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6200' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row7" class="expand-button"  type="button" onclick="toggleRow(7)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}"><div class="row">
            <div class="col">{{ row.obj }} - {{ row.Description }}</div>
            <div class="col"></div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td id="convertExpense{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td" id="pcs-total-5" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-6" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-7" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-8" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-9" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-10"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-11"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-12"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-13"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-14"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-15"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07"></a></td>
          <td class="collapsed right-align-td" id="pcs-total-16"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08"></a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      <script>

    
        var rowBudget = "{{ row.budget }}";
        var rowValue = parseFloat(rowBudget.replace(/,/g, ''));
        
        if (!isNaN(rowValue)) {
          convertExpense({{ forloop.counter }}, rowValue);
        }
    
        document.getElementById("row5-{{ forloop.counter }}").addEventListener("input", function(e) {
            var newValue = parseFloat(e.target.innerText.replace(/,/g, ''));
            if (!isNaN(newValue)) {
                convertValue({{ forloop.counter }}, newValue);
            }
        });
    </script>
    
    {% endif %}
      {%endfor%}

      <!-- END OF Professional and Cont Svcs-->

      {% for row in data_activities %}
      {% if row.Category == 'Supplies and Materials' %}
      
      <tr id="row8-{{ forloop.counter }}" class="sm-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6300' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row8" class="expand-button"  type="button" onclick="toggleRow(8)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}"><div class="row">
            <div class="col">{{ row.obj }} - {{ row.Description }}</div>
            <div class="col"></div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td id="convertExpense{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td" id="sm-total-5" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09"></a></td>
          <td class="collapsed right-align-td" id="sm-total-6" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10"></a></td>
          <td class="collapsed right-align-td" id="sm-total-7" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11"></a></td>
          <td class="collapsed right-align-td" id="sm-total-8" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12"></a></td>
          <td class="collapsed right-align-td" id="sm-total-9" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01"></a></td>
          <td class="collapsed right-align-td" id="sm-total-10"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02"></a></td>
          <td class="collapsed right-align-td" id="sm-total-11"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03"></a></td>
          <td class="collapsed right-align-td" id="sm-total-12"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04"></a></td>
          <td class="collapsed right-align-td" id="sm-total-13"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05"></a></td>
          <td class="collapsed right-align-td" id="sm-total-14"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06"></a></td>
          <td class="collapsed right-align-td" id="sm-total-15"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07"></a></td>
          <td class="collapsed right-align-td" id="sm-total-16"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08"></a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>

      <script>

    
        var rowBudget = "{{ row.budget }}";
        var rowValue = parseFloat(rowBudget.replace(/,/g, ''));
        
        if (!isNaN(rowValue)) {
          convertExpense({{ forloop.counter }}, rowValue);
        }
    
        document.getElementById("row5-{{ forloop.counter }}").addEventListener("input", function(e) {
            var newValue = parseFloat(e.target.innerText.replace(/,/g, ''));
            if (!isNaN(newValue)) {
                convertValue({{ forloop.counter }}, newValue);
            }
        });
    </script>
    {% endif %}
      {%endfor%}

      <!-- END OF Supplies and Materials-->

      {% for row in data_activities %}
      {% if row.Category == 'Other Operating Expenses' %}
      
      <tr id="row9-{{ forloop.counter }}" class="ooe-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"></td>
          <td ></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td" ><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6400' %}
      
      <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row9" class="expand-button"  type="button" onclick="toggleRow(9)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}"><div class="row">
            <div class="col">{{ row.obj }} - {{ row.Description }}</div>
            <div class="col"></div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td id="convertExpense{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td" id="ooe-total-5" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-6" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-7" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-8" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-9" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-10"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-11"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-12"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-13"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-14"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-15"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07"></a></td>
          <td class="collapsed right-align-td" id="ooe-total-16"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08"></a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>

      <script>

    
        var rowBudget = "{{ row.budget }}";
        var rowValue = parseFloat(rowBudget.replace(/,/g, ''));
        
        if (!isNaN(rowValue)) {
          convertExpense({{ forloop.counter }}, rowValue);
        }
    
        document.getElementById("row5-{{ forloop.counter }}").addEventListener("input", function(e) {
            var newValue = parseFloat(e.target.innerText.replace(/,/g, ''));
            if (!isNaN(newValue)) {
                convertValue({{ forloop.counter }}, newValue);
            }
        });
    </script>
    {% endif %}
      {%endfor%}


            <!-- END OF Other Operating Expenses-->


            {% for row in data_activities %}
      {% if row.Category == 'Total Expense' %}
      
      <tr id="row10-{{ forloop.counter }}" class="expense-row">
          <td class="firstcolumn"></td>
          <td class="collapsed"></td>
          <td class="right-align-td">{{ row.obj }} - {{ row.Description }}</td>
          <td class="right-align-td"> </td>
          <td ></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="09">{{row.total_activities9}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="10">{{row.total_activities10}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="11">{{row.total_activities11}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="12">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="01">{{row.total_activities1}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="02">{{row.total_activities2}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="03">{{row.total_activities3}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="04">{{row.total_activities4}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="05">{{row.total_activities5}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="06">{{row.total_activities6}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="07">{{row.total_activities7}}</a></td>
          <td class="collapsed right-align-td"><a href="#" class="viewglexpense-link" data-func="{{row.obj}}"  data-yr="08">{{row.total_activities8}}</a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>
      {%endif%}
      {%endfor%}

      {% for row in data_expensebyobject %}
      {% if row.obj == '6500'%}
          <tr id="row5-{{ forloop.counter }}" class="EOC-row">
          <td class="firstcolumn">
            <button id="row10" class="expand-button"  type="button" onclick="toggleRow(10)" style=" float: left;">+</button>
          </td>
          <td class="collapsed"></td>
          <td><input type="hidden" class="form-control" name="updatefuncfunc[]" placeholder="Description" value="{{row.func_func}}"><div class="row">
            <div class="col">{{ row.obj }} - {{ row.Description }}</div>
            <div class="col"></div>
          </div></td>
          <td id="value-cell-{{ forloop.counter }}" contenteditable="false" class="right-align-td">
            {% if row.budget == 0.0 or row.budget == None %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">
            {% else %}
            <input type="hidden" class="form-control" id="updatevalue-func-{{ forloop.counter }}" name="updatefuncbudget[]" placeholder="Description"  value="{{ row.budget }}">{{row.budget}}
            {% endif %} 
          </td>
          
          
          <td id="convertExpense{{ forloop.counter }}" class="right-align-td"></td>
          <td class="collapsed right-align-td" id="oe-total-5" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="09"></a></td>
          <td class="collapsed right-align-td" id="oe-total-6" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="10"></a></td>
          <td class="collapsed right-align-td" id="oe-total-7" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="11"></a></td>
          <td class="collapsed right-align-td" id="oe-total-8" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="12"></a></td>
          <td class="collapsed right-align-td" id="oe-total-9" ><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="01"></a></td>
          <td class="collapsed right-align-td" id="oe-total-10"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="02"></a></td>
          <td class="collapsed right-align-td" id="oe-total-11"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="03"></a></td>
          <td class="collapsed right-align-td" id="oe-total-12"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="04"></a></td>
          <td class="collapsed right-align-td" id="oe-total-13"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="05"></a></td>
          <td class="collapsed right-align-td" id="oe-total-14"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="06"></a></td>
          <td class="collapsed right-align-td" id="oe-total-15"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="07"></a></td>
          <td class="collapsed right-align-td" id="oe-total-16"><a href="#" class="viewglexpense-link" data-obj="{{row.obj}}"  data-yr="08"></a></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
          <td class="right-align-td"></td>
      </tr>

      <script>

    
        var rowBudget = "{{ row.budget }}";
        var rowValue = parseFloat(rowBudget.replace(/,/g, ''));
        
        if (!isNaN(rowValue)) {
          convertExpense({{ forloop.counter }}, rowValue);
        }
    
        document.getElementById("row5-{{ forloop.counter }}").addEventListener("input", function(e) {
            var newValue = parseFloat(e.target.innerText.replace(/,/g, ''));
            if (!isNaN(newValue)) {
                convertValue({{ forloop.counter }}, newValue);
            }
        });
    </script>
      {% endif %} 
      {%endfor%}
      <!-- END OF OPEARTING EXPENSE-->

     
     

      <tr id="" class="">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Total Expense</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="EOC-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="EOC-total-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>

      <tr id="" class="">
        <td class="firstcolumn"></td>
        <td class="collapsed"></td>
        <td  ><strong>Net Income</strong></td>
        <script>
          for (var i = 3; i <= 19; i++) {
            if (i >= 5 && i <= 16) {
              document.write(`<td  id="netincome-total-${i}" class="collapsed right-align-td" ></td>`);
            } else {
              document.write(`<td id="netincome-total-${i}" class=" right-align-td"></td>`);
            }
          }
        </script>
      </tr>


     
      

  


</tbody>
</table>
</form>
</div>



<script>
  function formatNumberWithCommas(number) {
    return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

</script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    
   
    var modal = document.getElementById("myModal");

      
      var modalTableBody = document.getElementById("modal-table-body");

     
      function populateModal(data) {
     
        modalTableBody.innerHTML = "";
      
       
        data.gl_data.forEach(function (row) {
          var newRow = document.createElement("tr");
          newRow.innerHTML = `
            <td class="right-align-td">${row.fund}</td>
            <td class="right-align-td">${row.func}</td>
            <td class="right-align-td">${row.obj}</td>
            <td class="right-align-td">${row.org}</td>
            <td class="right-align-td">${row.fscl_yr}</td>
            <td class="right-align-td">${row.pgm}</td>
            <td class="right-align-td">${row.projDtl}</td>
            <td class="right-align-td">${row.AcctDescr}</td>
            <td class="right-align-td">${row.Number}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.Date}</td>
            <td class="right-align-td">${row.AcctPer}</td>
            <td class="right-align-td">${row.Real}</td>
            <td class="right-align-td">${row.Expend}</td>
            <td class="right-align-td">${row.Bal}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.WorkDescr}</td>
            <td class="right-align-td">${row.Type}</td>
            
          `;
          modalTableBody.appendChild(newRow);
        });
        var totalRow = document.createElement("tr");
        totalRow.innerHTML = `
          <td colspan="11" style="text-align: right;">Total Balance</td>
          <td>$${data.total_bal}</td>
          <td colspan="4"></td>
        `;
        modalTableBody.appendChild(totalRow);
      }

    
    function fetchDataAndPopulateModal(fund, obj, yr) {
      fetch(`/viewgl/${fund}/${obj}/${yr}/`)
        .then(function (response) {
          
          return response.json();
        })
        .then(function (data) {
          
          if (data.status === "success") {
          
            populateModal(data.data , data.total_bal);
        
            modal.style.display = "block";
          } else {
            console.error(data.message);
          }
        })
        .catch(function (error) {
          console.error("Error fetching data:", error);
        });
    }

    // Add click event listeners to all "a" elements inside the table
    var viewGLLinks = document.querySelectorAll(".viewgl-link");
    viewGLLinks.forEach(function (link) {
      link.addEventListener("click", function (event) {
        event.preventDefault();
        var fund = link.dataset.fund;
        var obj = link.dataset.obj;
        var yr = link.dataset.yr;
        fetchDataAndPopulateModal(fund, obj , yr);
      });
    });

    // Close the modal when the close button is clicked
    var closeButton = modal.querySelector(".modal-footer button");
    closeButton.addEventListener("click", function () {
      modal.style.display = "none";
    });
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
  
    var modal = document.getElementById("myModal2");

     
      var modalTableBody = document.getElementById("modal2-table-body");

    
      function populateModal(data) {
      
        modalTableBody.innerHTML = "";
      
     
        data.glfunc_data.forEach(function (row) {
          var newRow = document.createElement("tr");
          newRow.innerHTML = `
            <td class="right-align-td">${row.fund}</td>
            <td class="right-align-td">${row.func}</td>
            <td class="right-align-td"> ${row.obj}</td>
            <td class="right-align-td">${row.org}</td>
            <td class="right-align-td">${row.fscl_yr}</td>
            <td class="right-align-td">${row.pgm}</td>
            <td class="right-align-td">${row.projDtl}</td>
            <td class="right-align-td">${row.AcctDescr}</td>
            <td class="right-align-td">${row.Number}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.Date}</td>
            <td class="right-align-td">${row.AcctPer}</td>
            <td class="right-align-td">${row.Real}</td>
            <td class="right-align-td">${row.Expend}</td>
            <td class="right-align-td">${row.Bal}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.WorkDescr}</td>
            <td class="right-align-td">${row.Type}</td>
            
          `;
          modalTableBody.appendChild(newRow);
        });
        var totalRow = document.createElement("tr");
        totalRow.innerHTML = `
          <td colspan="12" style="text-align: right;">Total Balance</td>
          <td>${data.total_bal}</td>
          <td colspan="3"></td>
        `;
        modalTableBody.appendChild(totalRow);
      }

   
    function fetchDataAndPopulateModal(func, yr) {
      fetch(`/viewglfunc/${func}/${yr}/`)
        .then(function (response) {
          
          return response.json();
        })
        .then(function (data) {
         
          if (data.status === "success") {
            
            populateModal(data.data,data.total_bal);
           
            modal.style.display = "block";
          } else {
            console.error(data.message);
          }
        })
        .catch(function (error) {
          console.error("Error fetching data:", error);
        });
    }

    var viewGLLinks = document.querySelectorAll(".viewglfunc-link");
    viewGLLinks.forEach(function (link) {
      link.addEventListener("click", function (event) {
        event.preventDefault();
        var func = link.dataset.func;
    
        var yr = link.dataset.yr;
        fetchDataAndPopulateModal(func, yr);
      });
    });

    // Close the modal when the close button is clicked
    var closeButton = modal.querySelector(".modal2-footer button");
    closeButton.addEventListener("click", function () {
      modal.style.display = "none";
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
   
    var modal = document.getElementById("myModal3");

      var modalTableBody = document.getElementById("modal3-table-body");

      function populateModal(data) {
   
        modalTableBody.innerHTML = "";
      
    
        data.glfunc_data.forEach(function (row) {
          var newRow = document.createElement("tr");
          newRow.innerHTML = `
            <td class="right-align-td">${row.fund}</td>
            <td class="right-align-td">${row.func}</td>
            <td class="right-align-td"> ${row.obj}</td>
            <td class="right-align-td">${row.org}</td>
            <td class="right-align-td">${row.fscl_yr}</td>
            <td class="right-align-td">${row.pgm}</td>
            <td class="right-align-td">${row.projDtl}</td>
            <td class="right-align-td">${row.AcctDescr}</td>
            <td class="right-align-td">${row.Number}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.Date}</td>
            <td class="right-align-td">${row.AcctPer}</td>
            <td class="right-align-td">${row.Real}</td>
            <td class="right-align-td">${row.Expend}</td>
            <td class="right-align-td">${row.Bal}</td>
            <td class="right-align-td" style="white-space: nowrap;">${row.WorkDescr}</td>
            <td class="right-align-td">${row.Type}</td>
            
          `;
          modalTableBody.appendChild(newRow);
        });
        var totalRow = document.createElement("tr");
        totalRow.innerHTML = `
          <td colspan="12" style="text-align: right;">Total Balance</td>
          <td>${data.total_bal}</td>
          <td colspan="3"></td>
        `;
        modalTableBody.appendChild(totalRow);
      }

    // Function to fetch the data from the server when modal is shown
    function fetchDataAndPopulateModal(func, yr) {
      fetch(`/viewglexpense/${func}/${yr}/`)
        .then(function (response) {
           
          return response.json();
        })
        .then(function (data) {
          console.log(data);
          if (data.status === "success") {
            // Populate the modal with the fetched data
            populateModal(data.data,data.total_bal);
            // Show the modal
            modal.style.display = "block";
          } else {
            console.error(data.message);
          }
        })
        .catch(function (error) {
          console.error("Error fetching data:", error);
        });
    }

    // Add click event listeners to all "a" elements inside the table
    var viewGLexpenseLinks = document.querySelectorAll(".viewglexpense-link");
    viewGLexpenseLinks.forEach(function (link) {
      link.addEventListener("click", function (event) {
        event.preventDefault();
        var obj = link.dataset.obj;
    
        var yr = link.dataset.yr;
        fetchDataAndPopulateModal(obj, yr);
      });
    });

    // Close the modal when the close button is clicked
    var closeButton = modal.querySelector(".modal3-footer button");
    closeButton.addEventListener("click", function () {
      modal.style.display = "none";
    });
  });
</script>

<script>
  function validateBudgetInput(event) {
    const input = event.target;
    const value = input.value;

    
    const regex = /^[0-9.]*$/;

    
    if (!regex.test(value)) {
        
        input.value = value.replace(/[^0-9.]/g, '');
    }
}

function toggleRow(rowId) {
  for (var i = 0; i <= 100; i++) {
    var row = document.getElementById("row" + rowId + "-" + i);
    if (row) {
      row.style.display = row.style.display === "none" ? "table-row" : "none";
    }
  }
  
  var rowElement = document.getElementById("row" + rowId);
  if (rowElement) {
    rowElement.innerHTML = rowElement.innerHTML === "-" ? "+" : "-";
  }
}

function toggleColumns() {
    var toggleButton = document.getElementById("toggle-button");
    var collapsedColumns = document.getElementsByClassName("collapsed");
    for (var i = 0; i < collapsedColumns.length; i++) {
      if (collapsedColumns[i].style.display === "none") {
        collapsedColumns[i].style.display = "table-cell";
        toggleButton.innerHTML = "-";
      } else {
        collapsedColumns[i].style.display = "none";
        toggleButton.innerHTML = "+";
      }
    }
  }

  function hideRowsByClass(className) {
    const rows = document.querySelectorAll(className);
    rows.forEach(row => {
      row.style.display = 'none';
    });
  }
  
  function hideRowsOnLoad() {
    const collapsedRows = document.querySelectorAll('.collapsed');
    collapsedRows.forEach(row => {
      row.style.display = 'none';
    });

    // Hide local revenue rows
    hideRowsByClass('.local-revenue-row');
    // Hide state program revenue rows
    hideRowsByClass('.spr-row');
    // Hide federal program revenue rows
    hideRowsByClass('.fpr-row');
    hideRowsByClass('.PCS-row');
    hideRowsByClass('.sm-row');
    hideRowsByClass('.ooe-row');
    hideRowsByClass('.expense-row');
    hideRowsByClass('.payroll-row');
    hideRowsByClass('.total-row1');
    hideRowsByClass('.DnA-row');
   
  }




  
 


window.addEventListener('DOMContentLoaded', () => {
  hideRowsOnLoad();




 
  

/* --------------revenue function ------------------*/
function calculateLocalRevenueTotal() {
  const rows = document.querySelectorAll('.local-revenue-row');
  const totalCells = [];

  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`local-revenue-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
}


      
      
      

      /* --------------spr function ------------------*/
function calculateSPRTotal() {
  const rows = document.querySelectorAll('.spr-row');
  const totalCells = [];

  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`spr-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
}

      
    
     /* --------------spr function ------------------*/
 function calculateFPRTotal() {
  const rows = document.querySelectorAll('.fpr-row');
  const totalCells = [];

   
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

   for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`fpr-total-${cellId}`);
    totalCells.push(totalCell);
  }

   let columnTotals = new Array(totalCells.length).fill(0);

   rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

   for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
 }


/* ------row 1 total --------- */
function calculaterow1Total() {
  const rows = document.querySelectorAll('.total-row1');
  const totalCells = [];

  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`total1-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
}
/*----------- calculate the local, state program and federal program revenue ----*/
function calculateLSFTotals() {
  const rows = document.querySelectorAll('.fpr-row, .spr-row, .local-revenue-row');
  const totalCells = [];

  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
}



/*---- year to date totals ------------*/
function calculateYTD() {
  const rows = document.querySelectorAll('.local-revenue-row, .spr-row, .fpr-row, .total-row1, .ttl-lr-row, .ttl-fpr-row, .ttl-spr-row, .ttl-1-row, .ttl-0-row');

  rows.forEach(row => {
    const cells = row.cells;
    let rowTotal = 0;
    for (let i = 5; i <= 18; i++) {
      const cellValue = parseFloat(cells[i].textContent.trim().replace('$', '').replace(/,/g, ''));
      if (!isNaN(cellValue)) {
        rowTotal += cellValue;
      }
    }

    
    if (row.classList.contains('ttl-lr-row') || row.classList.contains('ttl-fpr-row') || row.classList.contains('ttl-spr-row') || row.classList.contains('ttl-1-row') || row.classList.contains('ttl-0-row')) {
      cells[17].textContent = rowTotal !== 0 ? '$' + rowTotal.toLocaleString() : '';
    } else {
      cells[17].textContent = rowTotal !== 0 ? rowTotal.toLocaleString() : '';
    }
  });
}



/*----- Calculate Variances for spr  to 1st total------------ */
function CalculateVariances1() {
  const rows = document.querySelectorAll(' .spr-row, .fpr-row,  .ttl-lr-row, .ttl-fpr-row, .ttl-spr-row, .ttl-0-row');

  rows.forEach(row => {
    const cells = row.cells;
    let ytdCell = cells[17];
    let budgetCell = cells[4];
    
    
    let ytdValue = parseFloat(ytdCell.textContent.trim().replace('$', '').replace(/,/g, ''));
    let budgetValue = parseFloat(budgetCell.textContent.trim().replace('$', '').replace(/,/g, ''));

    if(isNaN(ytdValue)){
      ytdValue=0;

    }
    if(isNaN(budgetValue)){
      budgetValue=0;

    }
    
    
    const difference = ytdValue - budgetValue ;

   
    let formattedDifference = '';
    if (!isNaN(difference)) {
      if (difference < 0) {
        formattedDifference = `(${Math.abs(difference).toLocaleString()})`;
      } else {
        formattedDifference = `${difference.toLocaleString()}`;
      }
    }
    
    
    if (row.classList.contains('ttl-lr-row') || row.classList.contains('ttl-fpr-row') || row.classList.contains('ttl-spr-row') || row.classList.contains('ttl-1-row') || row.classList.contains('ttl-0-row')) {
      formattedDifference = `$${formattedDifference}`;
    }
    
    
    cells[18].textContent = difference !== 0 ? formattedDifference : '';
  });
}

/*----- Calculate Variances for total row 1 ex. data 2 from fund------------ */
function CalculateVariances2() {
  const rows = document.querySelectorAll('.total-row1, .ttl-1-row');

  rows.forEach(row => {
    const cells = row.cells;
    let ytdCell = cells[17];
    let budgetCell = cells[4];
    
    
    let ytdValue = parseFloat(ytdCell.textContent.trim().replace('$', '').replace(/,/g, ''));
    let budgetValue = parseFloat(budgetCell.textContent.trim().replace('$', '').replace(/,/g, ''));

    if(isNaN(ytdValue)){
      ytdValue=0;

    }
    if(isNaN(budgetValue)){
      budgetValue=0;

    }
    
    
    const difference = budgetValue- ytdValue ;

    
    let formattedDifference = '';
    if (!isNaN(difference)) {
      if (difference < 0) {
        formattedDifference = `(${Math.abs(difference).toLocaleString()})`;
      } else {
        formattedDifference = `${difference.toLocaleString()}`;
      }
    }
    
  
    if (row.classList.contains('ttl-lr-row') || row.classList.contains('ttl-fpr-row') || row.classList.contains('ttl-spr-row') || row.classList.contains('ttl-1-row') || row.classList.contains('ttl-0-row')) {
      formattedDifference = `$${formattedDifference}`;
    }
    
   
    cells[18].textContent = difference !== 0 ? formattedDifference : '';
  });
}


/*----- Calculate Variances for total row 1 ex. data 2 from fund------------ */
function CalculateVar42() {
  const rows = document.querySelectorAll('.total-row1, .ttl-1-row,  .ttl-lr-row, .ttl-fpr-row, .ttl-spr-row, .ttl-0-row');

  rows.forEach(row => {
    const cells = row.cells;
    let ytdCell = cells[17];
    let ammendedCell = cells[3];

    // Parse the values from the cells and remove any non-numeric characters
    let ytdValue = parseFloat(ytdCell.textContent.trim().replace('$', '').replace(/,/g, ''));
    let ammendedValue = parseFloat(ammendedCell.textContent.trim().replace('$', '').replace(/,/g, ''));

    if (isNaN(ytdValue)) {
      ytdValue = 0;
    }
    if (isNaN(ammendedValue)) {
      ammendedValue = 1; // To avoid division by zero
    }

    // Calculate the percentage
    const percentage = (ytdValue / ammendedValue) * 100;

    // Format the percentage with parentheses for negative values and append '%'
    let formattedPercentage = '';
    if (!isNaN(percentage)) {
      if (percentage < 0) {
        formattedPercentage = `(${Math.abs(percentage.toFixed(0))}%)`;
      } else {
        formattedPercentage = `${percentage.toFixed(0)}%`;
      }
    }

   

    // Display the result in cell[19]
    cells[19].textContent = percentage !== 0 ? formattedPercentage : '';
  });
}

var updateValuesArray = [];

 //---------------- update for local revenue, spr , fpr ------------------
 function updateLR(event) {
  var tdElement = event.target;
  var rowNumber = tdElement.id.split("-")[2];
  var updateValueInput = document.getElementById("updatevalue-" + rowNumber);

  var cellContent = tdElement.innerText.trim();
 

  var cleanedValue = cellContent.replace(/[^0-9.]/g, '');

  if (cleanedValue === "" || isNaN(parseFloat(cleanedValue))) {
    if (updateValueInput) {
      updateValueInput.value = 0; // Set to an empty string when cell is empty or not a number
    }
  } else {
    var value = parseFloat(cleanedValue);
    

    if (!isNaN(value) || value === 0) {
      if (updateValueInput) {
       

        updateValueInput.value = value;
      }
    } else {
      if (updateValueInput) {
       

        updateValueInput.value = 0;
      }
    }

  
    updateValuesArray[rowNumber - 1] = !isNaN(value) ? value : "";
  }
}


var tbodyElements = document.querySelectorAll('.local-revenue-row, .spr-row, .fpr-row ');
tbodyElements.forEach(function(tbodyElement) {
  tbodyElement.addEventListener("input", updateLR);
});
var tdElements = document.querySelectorAll('.local-revenue-row td[contenteditable], .spr-row td[contenteditable], .fpr-row td[contenteditable]');
tdElements.forEach(function(tdElement) {
  var rowNumber = tdElement.id.split("-")[2];
  updateLR({ target: tdElement });

});


var updateValuesArray2 = [];
//------------- update for func -----------
function updateFUNC(event) {
  var tdElement = event.target;
  var rowNumber = tdElement.id.split("-")[2];
  var updateValueInput = document.getElementById("updatevalue-func-" + rowNumber);

  var cellContent = tdElement.innerText.trim();


  var cleanedValue = cellContent.replace(/[^0-9.]/g, ''); // Remove non-numeric characters
  cleanedValue = cleanedValue.replace(/,/g, '');

  if (cleanedValue === "" || isNaN(parseFloat(cleanedValue))) {
    if (updateValueInput) {
      updateValueInput.value = 0; // Set to an empty string when cell is empty or not a number
    }
  }
   else {
    var value = parseFloat(cleanedValue);
    

    if (!isNaN(value) || value === 0) {
      if (updateValueInput) {


        updateValueInput.value = value;
      }
    } else {
      if (updateValueInput) {
        

        updateValueInput.value = 0;
      }
    }

    // Update the value in the updateValuesArray based on the rowNumber
    updateValuesArray2[rowNumber - 1] = !isNaN(value) ? value : "";
  }
}


var totalRow1Elements = document.querySelectorAll('.total-row1');
totalRow1Elements.forEach(function(totalRow1Element) {
  totalRow1Element.addEventListener("input", updateFUNC);
});

var funcElements = document.querySelectorAll('.total-row1 td[contenteditable]');
funcElements.forEach(function(tdElement) {
  var rowNumber = tdElement.id.split("-")[1];
  updateFUNC({ target: tdElement });
});

function SurplusDeficitTotal() {
  const rows = document.querySelectorAll('.fpr-row, .spr-row, .local-revenue-row');
  const totalCells = [];
  const rows2 = document.querySelectorAll('.total-row1');

  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`surplus-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);
  let columnTotals2 = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = extractNumericValue(cell.textContent);
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  rows2.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals2[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = columnTotals[i] - columnTotals2[i];
    const formattedTotal = columnTotal < 0 ? `$(${Math.abs(columnTotal).toLocaleString()})` : `$${columnTotal.toLocaleString()}`;
    totalCell.textContent = columnTotal !== 0 ? formattedTotal : '';
  }
 }

 
function CalculateVar42forSurplus() {
  const rows = document.querySelectorAll('.surplus-ttl-1-row' );

  rows.forEach(row => {
    const cells = row.cells;
    let ytdCell = cells[17];
    let ammendedCell = cells[3];

    // Parse the values from the cells and remove any non-numeric characters
    let ytdValue = parseFloat(ytdCell.textContent.trim().replace('$', '').replace(/,/g, '').replace('(', '-').replace(')', ''));
    let ammendedValue = parseFloat(ammendedCell.textContent.trim().replace('$', '').replace(/,/g, '').replace('(', '-').replace(')', ''));

    if (isNaN(ytdValue)) {
      ytdValue = 0;
    }
    if (isNaN(ammendedValue)) {
      ammendedValue = 1; // 
    }



    // Calculate the percentage
    const percentage = (ytdValue / ammendedValue) * 100;

    
    
    let formattedPercentage = `${percentage.toFixed(0)}%`;
     

   

    
    cells[19].textContent = percentage !== 0 ? formattedPercentage : '';
  });
}


//variance for surplus deficits before depreciation
function CalculateVariances3() {
  const rows = document.querySelectorAll('.surplus-ttl-1-row');

  rows.forEach(row => {
    const cells = row.cells;
    let ytdCell = cells[17];
    let budgetCell = cells[4];
    
    
    let ytdValue = parseFloat(ytdCell.textContent.trim().replace('$', '').replace(/,/g, '').replace('(', '-').replace(')', ''));
    let budgetValue = parseFloat(budgetCell.textContent.trim().replace('$', '').replace(/,/g, '').replace('(', '-').replace(')', ''));

    if(isNaN(ytdValue)){
      ytdValue=0;

    }
    if(isNaN(budgetValue)){
      budgetValue=0;

    }
 
    
    const difference = ytdValue - budgetValue ;

    
    let formattedDifference = '';
    if (!isNaN(difference)) {
      if (difference < 0) {
        formattedDifference = `(${Math.abs(difference).toLocaleString()})`;
      } else {
        formattedDifference = `${difference.toLocaleString()}`;
      }
    }
    
  
    if (row.classList.contains('surplus-ttl-1-row')) {
      formattedDifference = `$${formattedDifference}`;
    }
    
   
    cells[18].textContent = difference !== 0 ? formattedDifference : '';
  });
}

function extractNumericValue(content) {
  const match = content.match(/\(([^)]+)\)/);
  if (match) {
    const numericValue = parseFloat(match[1].replace(/,/g, '').trim());
    return isNaN(numericValue) ? 0 : -numericValue;
  } else {
    const numericValue = parseFloat(content.replace(/,/g, '').trim());
    return isNaN(numericValue) ? 0 : numericValue;
  }
}



/* --------------PayrollCostTotal function ------------------*/
function PayrollCostTotal() {
  const rows = document.querySelectorAll('.payroll-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`payroll-row-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseFloat(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  columnTotal.toLocaleString() : '';
  }
}

//----------------PROFESSIONAL AND CONT SVCS
function PCSTotal() {
  const rows = document.querySelectorAll('.PCS-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`pcs-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  columnTotal.toLocaleString() : '';
  }
}

function SMTotal() {
  const rows = document.querySelectorAll('.sm-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`sm-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseFloat(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  columnTotal.toLocaleString() : '';
  }
}


//---------- OTHER OPERATING EXPENSES TOTAL 
function OOETotal() {
  const rows = document.querySelectorAll('.ooe-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`ooe-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  columnTotal.toLocaleString() : '';
  }
}

function OperatingExpenseTotal() {
  const rows = document.querySelectorAll('.expense-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`oe-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' +  columnTotal.toLocaleString() : '';
  }
}

// -------------- TOTAL EXPENSE FUNCTION
/*function ExpenseTotal() {
  const rows = document.querySelectorAll('.ooe-row, .sm-row, .PCS-row , .payroll-row , expense-row');
  const totalCells = [];

  
  const totalCellIds = [ 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`expense-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ? '$' + columnTotal.toLocaleString() : '';
  }
} */



//----------------Total Expense by object function
function totalEOC() { 
  const rows = document.querySelectorAll('.EOC-row');
  const totalCells = [];

  
  const totalCellIds = [ 3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`EOC-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  '$' + columnTotal.toLocaleString() : '';
  }
}

//----------------Total Expense by object function
function DandATotal() {
  const rows = document.querySelectorAll('.DnA-row');
  const totalCells = [];

  
  const totalCellIds = [ 3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`DnA-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
    const columnTotal = parseInt(columnTotals[i]);
    totalCell.textContent = columnTotal !== 0 ?  columnTotal.toLocaleString() : '';
  }
}

function NetSurplusTotal() {
  const rows = document.querySelectorAll('.fpr-row, .spr-row, .local-revenue-row');
  const totalCells = [];
  const rows2 = document.querySelectorAll('.total-row1');
  const rows3 = document.querySelectorAll('.DnA-row');
  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`net-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);
  let columnTotals2 = new Array(totalCells.length).fill(0);
  let columnTotals3 = new Array(totalCells.length).fill(0);

  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = extractNumericValue(cell.textContent);
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  rows2.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals2[j] += value;
            break;
          }
        }
      }
    }
  });

  rows3.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = extractNumericValue(cell.textContent);
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals3[j] += value;
       
            break;
          }
        }
      }
    }
  });

  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
 
    const columnTotal = (columnTotals[i] - columnTotals2[i])+columnTotals3[i];
    const formattedTotal = columnTotal < 0 ? `$(${Math.abs(columnTotal).toLocaleString()})` : `$${columnTotal.toLocaleString()}`;
    totalCell.textContent = columnTotal !== 0 ? formattedTotal : '';
  }
 }

 function NetIncomeTotal() {
  const rows = document.querySelectorAll('.fpr-row, .spr-row, .local-revenue-row');
  const totalCells = [];
  const rows2 = document.querySelectorAll('.EOC-row');
 
  
  const totalCellIds = [3,4, 5,6,7,8,9,10,11,12,13,14,15,16,17];

  for (let i = 0; i < totalCellIds.length; i++) {
    const cellId = totalCellIds[i];
    const totalCell = document.getElementById(`netincome-total-${cellId}`);
    totalCells.push(totalCell);
  }

  let columnTotals = new Array(totalCells.length).fill(0);
  let columnTotals2 = new Array(totalCells.length).fill(0);


  rows.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = extractNumericValue(cell.textContent);
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals[j] += value;
            break;
          }
        }
      }
    }
  });

  rows2.forEach(row => {
    const cells = row.cells;
    for (let i = 3; i < cells.length; i++) {
      const cell = cells[i];
      const value = parseFloat(cell.textContent.replace(/,/g, '').trim());
      if (!isNaN(value)) {
        for (let j = 0; j < totalCells.length; j++) {
          if (i === totalCellIds[j]) {
            columnTotals2[j] += value;
            break;
          }
        }
      }
    }
  });



  for (let i = 0; i < totalCells.length; i++) {
    const totalCell = totalCells[i];
 
    const columnTotal = columnTotals[i] - columnTotals2[i];
    const formattedTotal = columnTotal < 0 ? `$(${Math.abs(columnTotal).toLocaleString()})` : `$${columnTotal.toLocaleString()}`;
    totalCell.textContent = columnTotal !== 0 ? formattedTotal : '';
  }
 }

 
    const editableCells = document.querySelectorAll('.local-revenue-row td[contenteditable], .spr-row td[contenteditable], .fpr-row td[contenteditable], .total-row1 td[contenteditable]');
    editableCells.forEach(cell => {
      cell.addEventListener('input', () => {
        
        calculateLocalRevenueTotal();
        calculateSPRTotal();
        calculateFPRTotal();
        calculaterow1Total();
        calculateLSFTotals();
        
        CalculateVariances1();
        CalculateVariances2();
        CalculateVar42();
        SurplusDeficitTotal();
        CalculateVariances3();
        
        CalculateVar42forSurplus();
        PayrollCostTotal();
        PCSTotal();
        SMTotal();
        OperatingExpenseTotal();
        OOETotal();
        //ExpenseTotal();
        totalEOC();
        DandATotal();
        NetSurplusTotal();
        NetIncomeTotal();
        
        
      });
    });
    
    calculateLocalRevenueTotal();
    calculateSPRTotal();
    calculateFPRTotal();
    calculaterow1Total();
    calculateLSFTotals();
    calculateYTD();
    CalculateVariances1();
    CalculateVariances2();
    CalculateVar42();
    SurplusDeficitTotal();
    CalculateVariances3();
    
    CalculateVar42forSurplus();
    PayrollCostTotal();
    PCSTotal();
    SMTotal();
    OperatingExpenseTotal();
    OOETotal();
    //ExpenseTotal();
    totalEOC();
    DandATotal();
    NetSurplusTotal();
    NetIncomeTotal();
});



</script>


<!--<script src="{% static 'js/pl_advantage.js' %}"></script> -->
{% endblock %}


